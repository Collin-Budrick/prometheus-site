import{t as ge}from"./q-B9iggP75.js";import{A as fi,C as W,D as X,E as le,O as Ve,S as te,T as N,_ as z,a as mi,b as Le,c as bt,d as pi,f as Wt,g as se,h as ce,i as Ht,k as ot,l as gi,m as Gt,n as yi,o as bi,p as Ue,r as vi,s as wi,t as qt,u as Si,v as m,w as Pi,x as xi,y as Se}from"./q-t4UR9BLa.js";import{partytownSnippet as $i}from"@builder.io/partytown/integration";import Je from"postgres";import{numeric as Ti,pgTable as Yt,serial as Xt,text as lt,timestamp as Zt}from"drizzle-orm/pg-core";const ut=["en","ko"],vt={en:"English",ko:"한국어"};let Ye="en",ve,er=()=>{if(ve)return ve;if(typeof document<"u"){const e=document.documentElement.lang;e&&e in vt&&(ve=e)}return ve||(ve=Ye),ve};var Ci=e=>vt[e]?e:(console.error(`unknown locale ${e}`),Ye);const Ni=e=>{er=()=>ve=Ci(e())};var _i=(e,t=[])=>{for(let r=0;typeof e=="object";r++){let i=e[t[r]]??e["*"];typeof i=="number"&&(i=e[i]),e=i}return typeof e=="string"?e.replace(/\$([\d$])/g,(r,i)=>i==="$"?"$":String(t[Number(i)-1]??"")):""},Ai=e=>e.map((t,r)=>`${r}${t.replace(/\$/g,()=>"$$")}`).join("$").slice(1);const Li="English",qi={"Performance Lab":"Performance Lab",Home:"Home",Store:"Store",Chat:"Chat",AI:"AI","Performance first":"Performance first","Microscopic first load, big capability":"Microscopic first load, big capability","Qwik City SSR keeps the shell light. Navigation is enhanced with View Transitions and Speculation Rules when the browser supports them, and third-party scripts stay off the main thread.":"Qwik City SSR keeps the shell light. Navigation is enhanced with View Transitions and Speculation Rules when the browser supports them, and third-party scripts stay off the main thread.","- Ultra-thin home route with immutable caching":"- Ultra-thin home route with immutable caching","- Lazy feature routes for store, chat, and AI":"- Lazy feature routes for store, chat, and AI","- Optional Partytown for third-party isolation":"- Optional Partytown for third-party isolation","Latency budget":"Latency budget","Server render: sub-50ms target with streaming enabled":"Server render: sub-50ms target with streaming enabled","Critical CSS: UnoCSS + Lightning CSS keeps payloads tiny":"Critical CSS: UnoCSS + Lightning CSS keeps payloads tiny","Speculative nav: prerender store, prefetch chat":"Speculative nav: prerender store, prefetch chat","Sample adapter (offline)":"Sample adapter (offline)","Edge cache pack (offline)":"Edge cache pack (offline)","Invalid id.":"Invalid id.","Item not found.":"Item not found.","Unable to delete item right now.":"Unable to delete item right now.","Name and positive price required.":"Name and positive price required.","Unable to create item right now.":"Unable to create item right now.","Database offline: showing fallback inventory.":"Database offline: showing fallback inventory.","Unable to load inventory right now.":"Unable to load inventory right now.","Fast browsing with tiny payloads":"Fast browsing with tiny payloads",cached:"cached","Items stream directly from Postgres via Drizzle, with cursor pagination to keep responses lean. Data only wakes up once the route is visible to keep initial payloads microscopic.":"Items stream directly from Postgres via Drizzle, with cursor pagination to keep responses lean. Data only wakes up once the route is visible to keep initial payloads microscopic.",Inventory:"Inventory",Refresh:"Refresh","Showing fallback data while the database is unavailable.":"Showing fallback data while the database is unavailable.","Inventory loads once this section is visible.":"Inventory loads once this section is visible.","SKU $1":"SKU $1","Delete $1":"Delete $1",Delete:"Delete","No items yet.":"No items yet.","Load more":"Load more","Loading...":"Loading...","Add an item":"Add an item",Name:"Name","Lightweight widget":"Lightweight widget",Price:"Price","Saving...":"Saving...","Create item":"Create item","Added $1.":"Added $1.",Realtime:"Realtime","WebSocket chat via Valkey pub/sub":"WebSocket chat via Valkey pub/sub",websocket:"websocket","The client only loads after navigation to keep the home route microscopic. Connect on demand to keep bfcache eligibility until realtime is needed. Messages fan out through Valkey channels on the API.":"The client only loads after navigation to keep the home route microscopic. Connect on demand to keep bfcache eligibility until realtime is needed. Messages fan out through Valkey channels on the API.",Connected:"Connected","Connect to chat":"Connect to chat","No socket opened until you opt in.":"No socket opened until you opt in.","No messages yet.":"No messages yet.","Say something quick":"Say something quick",Send:"Send","AI tools":"AI tools","Edge-friendly utilities":"Edge-friendly utilities","This route keeps the interaction simple: a round-trip echo API that exercises Bun + Elysia without shipping extra client bundles.":"This route keeps the interaction simple: a round-trip echo API that exercises Bun + Elysia without shipping extra client bundles.","Type a quick prompt":"Type a quick prompt","Send to API":"Send to API","Response: $1":"Response: $1","Prometheus | Ultra-fast starter":"Prometheus | Ultra-fast starter","Qwik City + Bun + Valkey performance stack starter.":"Qwik City + Bun + Valkey performance stack starter.","Store | Prometheus":"Store | Prometheus","Drizzle-powered store pulling from Postgres with cursor pagination and lazy loading.":"Drizzle-powered store pulling from Postgres with cursor pagination and lazy loading.","Chat | Prometheus":"Chat | Prometheus","WebSocket chat backed by Valkey pub/sub.":"WebSocket chat backed by Valkey pub/sub.","AI | Prometheus":"AI | Prometheus","Minimal AI utility route hitting Bun API.":"Minimal AI utility route hitting Bun API.","Items stream directly from Postgres via Drizzle, with cursor pagination to keep responses lean. Interactivity wakes up only when you click.":""};var Bi={locale:"en",name:Li,translations:qi};const Qi="한국어",ki={"Performance Lab":"퍼포먼스 랩",Home:"홈",Store:"스토어",Chat:"채팅",AI:"AI","Performance first":"성능 우선","Microscopic first load, big capability":"초소형 첫 로드, 큰 역량","Qwik City SSR keeps the shell light. Navigation is enhanced with View Transitions and Speculation Rules when the browser supports them, and third-party scripts stay off the main thread.":"Qwik City SSR은 셸을 가볍게 유지합니다. 브라우저가 View Transitions와 Speculation Rules를 지원하면 탐색이 강화되고, 서드파티 스크립트는 메인 스레드를 벗어납니다.","- Ultra-thin home route with immutable caching":"- 초경량 홈 라우트와 불변 캐싱","- Lazy feature routes for store, chat, and AI":"- 스토어, 채팅, AI를 위한 지연 로드 기능 라우트","- Optional Partytown for third-party isolation":"- 서드파티 격리를 위한 Partytown 선택 옵션","Latency budget":"레이턴시 예산","Server render: sub-50ms target with streaming enabled":"서버 렌더링: 스트리밍 사용 시 50ms 미만 목표","Critical CSS: UnoCSS + Lightning CSS keeps payloads tiny":"크리티컬 CSS: UnoCSS + Lightning CSS로 페이로드를 최소화","Speculative nav: prerender store, prefetch chat":"추측 탐색: 스토어 프리렌더, 채팅 프리패치","Sample adapter (offline)":"샘플 어댑터(오프라인)","Edge cache pack (offline)":"엣지 캐시 팩(오프라인)","Invalid id.":"유효하지 않은 ID입니다.","Item not found.":"항목을 찾을 수 없습니다.","Unable to delete item right now.":"지금은 항목을 삭제할 수 없습니다.","Name and positive price required.":"이름과 양수 가격이 필요합니다.","Unable to create item right now.":"지금은 항목을 생성할 수 없습니다.","Database offline: showing fallback inventory.":"데이터베이스 오프라인: 대체 인벤토리를 표시합니다.","Unable to load inventory right now.":"지금은 인벤토리를 불러올 수 없습니다.","Fast browsing with tiny payloads":"초소형 페이로드로 빠른 탐색",cached:"캐시됨","Items stream directly from Postgres via Drizzle, with cursor pagination to keep responses lean. Data only wakes up once the route is visible to keep initial payloads microscopic.":"항목은 Drizzle을 통해 Postgres에서 직접 스트리밍되며, 응답을 가볍게 유지하기 위해 커서 페이지네이션을 사용합니다. 데이터는 라우트가 보일 때만 깨어나 초기 페이로드를 극소화합니다.",Inventory:"인벤토리",Refresh:"새로고침","Showing fallback data while the database is unavailable.":"데이터베이스를 사용할 수 없어 대체 데이터를 표시합니다.","Inventory loads once this section is visible.":"이 섹션이 보일 때 인벤토리가 로드됩니다.","SKU $1":"SKU $1","Delete $1":"$1 삭제",Delete:"삭제","No items yet.":"아직 항목이 없습니다.","Load more":"더 불러오기","Loading...":"로딩 중...","Add an item":"항목 추가",Name:"이름","Lightweight widget":"경량 위젯",Price:"가격","Saving...":"저장 중...","Create item":"항목 만들기","Added $1.":"$1 추가됨.",Realtime:"실시간","WebSocket chat via Valkey pub/sub":"Valkey pub/sub 기반 WebSocket 채팅",websocket:"웹소켓","The client only loads after navigation to keep the home route microscopic. Connect on demand to keep bfcache eligibility until realtime is needed. Messages fan out through Valkey channels on the API.":"클라이언트는 홈 라우트를 극소화하기 위해 탐색 후에만 로드됩니다. 실시간이 필요할 때까지 bfcache 자격을 유지하도록 필요 시 연결합니다. 메시지는 API의 Valkey 채널을 통해 브로드캐스트됩니다.",Connected:"연결됨","Connect to chat":"채팅에 연결","No socket opened until you opt in.":"동의하기 전에는 소켓을 열지 않습니다.","No messages yet.":"메시지가 아직 없습니다.","Say something quick":"간단히 입력하세요",Send:"보내기","AI tools":"AI 도구","Edge-friendly utilities":"엣지 친화적 유틸리티","This route keeps the interaction simple: a round-trip echo API that exercises Bun + Elysia without shipping extra client bundles.":"이 라우트는 상호작용을 단순하게 유지합니다. 추가 클라이언트 번들을 보내지 않고 Bun + Elysia를 테스트하는 왕복 에코 API입니다.","Type a quick prompt":"간단한 프롬프트를 입력하세요","Send to API":"API로 보내기","Response: $1":"응답: $1","Prometheus | Ultra-fast starter":"Prometheus | 초고속 스타터","Qwik City + Bun + Valkey performance stack starter.":"Qwik City + Bun + Valkey 성능 스택 스타터.","Store | Prometheus":"스토어 | Prometheus","Drizzle-powered store pulling from Postgres with cursor pagination and lazy loading.":"Drizzle 기반 스토어로 Postgres에서 커서 페이지네이션과 지연 로드를 사용해 불러옵니다.","Chat | Prometheus":"채팅 | Prometheus","WebSocket chat backed by Valkey pub/sub.":"Valkey pub/sub 기반 WebSocket 채팅.","AI | Prometheus":"AI | Prometheus","Minimal AI utility route hitting Bun API.":"Bun API를 호출하는 최소 AI 유틸리티 라우트.","Items stream directly from Postgres via Drizzle, with cursor pagination to keep responses lean. Interactivity wakes up only when you click.":""};var Ii={locale:"ko",fallback:"en",name:Qi,translations:ki},ji={en:Bi,ko:Ii},Di=(e,t,r)=>{let i,s;do i=ji[e],s=i.translations[t];while(!s&&(e=i.fallback));return s||(s=t),_i(s,r)},zi=(e,...t)=>Di(er(),typeof e=="string"?e:Ai(e),t),y=zi,ct=e=>{if(!e)return;const t=e.trim();if(!t)return;const r=t.replace(/_/g,"-").toLowerCase(),i=r==="kr"?"ko":r,s=ut.find(o=>o.toLowerCase()===i);if(s)return s;const n=i.split("-")[0];if(n)return ut.find(o=>o.toLowerCase()===n)},Oi=e=>{if(!e)return;const t=e.split(",");for(const r of t){const i=r.split(";")[0],s=ct(i);if(s)return s}};const wt=({queryLocale:e,cookieLocale:t,acceptLanguage:r})=>ct(e)||ct(t)||Oi(r)||Ye;var Fi={path:"/",sameSite:"lax",maxAge:31536e3};const Vi=e=>({query:t,cookie:r,headers:i,locale:s})=>{const n=e({queryLocale:t.get("locale"),cookieLocale:r.get("locale")?.value,acceptLanguage:i.get("accept-language")});t.has("locale")&&(r.delete("locale"),r.delete("locale",{path:"/"}),r.set("locale",n,Fi)),s(n)};var Ei=ge({onRequest:()=>Ri},1);const Ri=Vi(wt);var Mi=new Set(["style","font"]);const Ui=(e,t,r)=>{const i=new Set;return Array.from(e??[]).filter(s=>{if(s.rel!=="preload")return!0;if(t)return!1;const n=s.href,o=s.as;return typeof n!="string"||n.trim().length===0||r&&!r.has(n)||typeof o!="string"||!Mi.has(o)||i.has(n)?!1:(i.add(n),!0)})};var Ji=[];const Ki=(e,t)=>[];var Wi=e=>typeof e=="string"&&e.trim().length>0;const Hi=new Set(Ji.flatMap(({links:e})=>e.map(t=>t.href)).filter(Wi));var Gi=(e,t)=>e===void 0?t:typeof e=="boolean"?e:e==="1"||e.toLowerCase()==="true",it=(e,t)=>Gi(e,t&&!0);const _e={speculationRules:it(void 0,!0),viewTransitions:it(void 0,!0),partytown:it(void 0,!0)};var Yi=async e=>{const[t,r,i]=le();if(r||e.defaultPrevented||e.button!==0||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)return;if(e.preventDefault(),typeof document>"u"){await i(t);return}const s=document,n=_e.viewTransitions?s.startViewTransition:void 0;if(n){n.call(s,()=>i(t))?.finished.catch(()=>{});return}await i(t)},Xi=()=>{const e=bt(),t=gi(),r=wt({queryLocale:e.url.searchParams.get("locale"),cookieLocale:typeof document<"u"?document.cookie.split(";").map(s=>s.trim()).find(s=>s.startsWith("locale="))?.split("=")[1]:void 0,acceptLanguage:typeof navigator<"u"?navigator.languages?.join(",")||navigator.language:void 0}),i=s=>{const n=new URLSearchParams(e.url.search);n.set("locale",s);const o=n.toString();return`${e.url.pathname}${o?`?${o}`:""}`};return m("div",null,{class:"flex items-center gap-1 text-xs"},ut.map(s=>{const n=s===r,o=i(s);return m("a",{href:o,"aria-disabled":n,style:n?{viewTransitionName:"locale-pill"}:void 0,class:["rounded-full border px-2 py-1 transition-colors",n?"border-emerald-500/40 bg-emerald-500/10 text-emerald-200 pointer-events-none":"border-slate-700 text-slate-300 hover:text-emerald-200 hover:border-emerald-500/40"].join(" "),onClick$:N(Yi,"s_CskzXQBKCjQ",[o,n,t])},null,vt[s]??s.toUpperCase(),0,s)}),1,"mU_0")};const Zi=W(N(Xi,"s_00eYrYyi6VA"));var st=e=>{const t=typeof import.meta<"u"&&{BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!0}[e];if(t!==void 0)return t;if(typeof process<"u")return process.env?.[e]??process.env?.[e.replace(/^VITE_/,"")]},G={gaId:st("VITE_GTAG_ID"),adsClient:st("VITE_ADSENSE_CLIENT"),supportWidgetSrc:st("VITE_SUPPORT_WIDGET_SRC")},tr=[{id:"gtag",label:"Google Analytics 4",category:"analytics",src:G.gaId?`https://www.googletagmanager.com/gtag/js?id=${G.gaId}`:void 0,inline:G.gaId?`window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', '${G.gaId}', { transport_type: 'beacon', send_page_view: true });`:void 0,forward:["dataLayer.push","gtag"],attributes:{async:!0,"data-gtm-id":G.gaId},budgetKb:90,load:"defer",partytown:!0,fallback:"Falls back to async tag when Partytown is disabled.",when:!!G.gaId},{id:"adsense",label:"Google AdSense",category:"ads",src:G.adsClient?`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${G.adsClient}`:void 0,forward:["adsbygoogle.push"],attributes:{async:!0,"data-ad-client":G.adsClient,crossOrigin:"anonymous"},budgetKb:95,load:"idle",partytown:!0,fallback:"Loads on idle/timeout when Partytown is off to avoid blocking hydration.",when:!!G.adsClient},{id:"support-widget",label:"Support chat widget",category:"widget",src:G.supportWidgetSrc,budgetKb:120,load:"interaction",partytown:!1,fallback:"Injected after user input, idle callback, or 5s timeout.",when:!!G.supportWidgetSrc}];const Me=tr.filter(e=>e.when),Rl=Array.from(new Set(tr.flatMap(e=>e.forward??[])));var es=(e,t)=>`(()=>{const url='${t}';let loaded=false;const load=()=>{if(loaded||!url)return;loaded=true;const s=document.createElement('script');s.src=url;s.async=true;s.dataset.thirdParty='${e}';document.body.appendChild(s);};const prime=()=>{load();cleanup();};const cleanup=()=>events.forEach((event)=>window.removeEventListener(event,prime,opts));const events=['pointerdown','keydown','touchstart','focusin'];const opts={once:true,passive:true};events.forEach((event)=>window.addEventListener(event,prime,opts));if('requestIdleCallback'in window){requestIdleCallback(()=>prime(),{timeout:5000});}else{setTimeout(prime,5000);}setTimeout(load,8000);})();`,ts=()=>{const e=Me.some(r=>r.partytown),t=_e.partytown?Array.from(new Set(Me.flatMap(r=>r.forward??[]))):[];return Me.length?z(Ue,{children:[_e.partytown&&e&&m("script",{dangerouslySetInnerHTML:$i({lib:"/~partytown/",forward:t})},null,null,3,"dH_0"),Me.map(r=>{if(!r.src&&!r.inline)return null;const i=r.attributes??{};if(r.partytown&&_e.partytown)return z(Ue,{children:[r.src&&Se("script",{type:"text/partytown",...i,get src(){return r.src},src:te(r,"src")},{type:ce},0,"dH_1"),r.inline&&Se("script",{type:"text/partytown",...i,get dangerouslySetInnerHTML(){return r.inline},dangerouslySetInnerHTML:te(r,"inline")},{type:ce},0,"dH_2")]},1,r.id);if(r.load==="interaction"&&r.src)return m("script",{dangerouslySetInnerHTML:es(r.id,r.src)},null,null,3,`${r.id}-loader`);const s=r.load==="defer"?{defer:!0}:{async:!0};return z(Ue,{children:[r.src&&Se("script",{...i,...s,get src(){return r.src},src:te(r,"src")},null,0,"dH_3"),r.inline&&Se("script",{...i,...s,get dangerouslySetInnerHTML(){return r.inline},dangerouslySetInnerHTML:te(r,"inline")},null,0,"dH_4")]},1,r.id)})]},1,"dH_5"):null};const rs=W(N(ts,"s_mLjU5QE56DA"));var is=".route-transition{view-transition-name:route;contain:paint}",ss=`:root {
  color-scheme: light dark;
}

:root[data-theme='light'],
:root.light {
  color-scheme: light;
}

:root[data-theme='dark'],
:root.dark {
  color-scheme: dark;
}

body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background-color: #020617;
  color: #e2e8f0;
  min-height: 100vh;
}
`,ns=ge({RouterHead:()=>sr,_auto_isNonEmptyString:()=>rr,_auto_speculationCandidates:()=>St,_auto_toSpeculationRules:()=>ir,default:()=>ls},1),St=[{url:"/store",action:"prerender"},{url:"/chat",action:"prefetch"}],rr=e=>typeof e=="string"&&e.trim().length>0,ir=e=>{const t=St.filter(({url:r})=>r!==e).reduce((r,i)=>(r[i.action].push({source:"list",urls:[i.url]}),r),{prefetch:[],prerender:[]});return t.prefetch.length||t.prerender.length?t:null},as=()=>{const e=wi(),t=bt(),r=_e.speculationRules&&!0,i=r?ir(t.url.pathname):null,s=Ki(t.url.pathname,!1),n=new Set([...Hi,...s.map(c=>c.href).filter(rr)]),o=Ui([...e.links,...s],!1,n),l=!1,d=r&&i?`(()=>{try{if(navigator.connection?.saveData)return;if(!HTMLScriptElement.supports?.('speculationrules'))return;const payload=${JSON.stringify(i)};const script=document.createElement('script');script.type='speculationrules';script.textContent=JSON.stringify(payload);document.head.append(script);}catch{}})();`:void 0;return z(Ue,{children:[m("title",null,null,e.title||"Prometheus",1,null),m("meta",null,{name:"viewport",content:"width=device-width, initial-scale=1, viewport-fit=cover"},null,3,null),m("link",null,{rel:"canonical",href:se(c=>c.url.href,[t],"p0.url.href")},null,3,null),m("style",null,{"data-critical":!0,dangerouslySetInnerHTML:ss},null,3,null),e.meta.map(c=>Se("meta",{...c},null,0,c.key)),o.map(c=>Se("link",{...c},null,0,c.key)),r&&St.filter(({url:c})=>c!==t.url.pathname).map(({url:c,action:p})=>m("link",{rel:p,href:c},null,null,3,`${p}:${c}`)),e.styles.map(c=>Se("style",{...c.props,get dangerouslySetInnerHTML(){return c.style},dangerouslySetInnerHTML:te(c,"style")},null,0,c.key)),d&&m("script",{dangerouslySetInnerHTML:d},null,null,3,"qG_0"),_e.viewTransitions&&m("script",null,{dangerouslySetInnerHTML:"if ('startViewTransition' in document) {document.documentElement.classList.add('supports-view-transition');}"},null,3,"qG_1"),z(rs,null,3,"qG_2"),l]},1,"qG_4")};const sr=W(N(as,"s_0ZAFccQi4aM"));var os=()=>(Ve(N(is,"s_ovuN5RMiUy0")),m("div",null,{class:"min-h-screen bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950"},[m("header",null,{class:"sticky top-0 z-20 border-b border-slate-800 bg-slate-950/80 backdrop-blur"},m("nav",null,{class:"mx-auto flex max-w-5xl items-center justify-between px-4 py-3 text-sm font-medium"},[m("div",null,{class:"flex items-center gap-2"},[m("span",null,{class:"rounded-full bg-emerald-500/10 px-3 py-1 text-emerald-300"},"Prometheus",3,null),m("span",null,{class:"text-slate-400"},y`Performance Lab`,1,null)],1,null),m("div",null,{class:"flex items-center gap-4 text-slate-200"},[m("a",null,{href:"/",class:"hover:text-emerald-300 transition-colors"},y`Home`,1,null),m("a",null,{href:"/store","data-speculate":"prefetch",class:"hover:text-emerald-300 transition-colors"},y`Store`,1,null),m("a",null,{href:"/chat","data-speculate":"prefetch",class:"hover:text-emerald-300 transition-colors"},y`Chat`,1,null),m("a",null,{href:"/ai",class:"hover:text-emerald-300 transition-colors"},y`AI`,1,null),z(Zi,null,3,"qG_5")],1,null)],1,null),1,null),m("main",null,{class:"mx-auto flex max-w-5xl flex-col gap-6 px-4 py-10 route-transition"},z(Gt,null,3,"qG_6"),1,null)],1,"qG_7")),ls=W(N(os,"s_wqKL2Up903o")),us=".home-grid{gap:1.5rem;display:grid}@media (width>=768px){.home-grid{grid-template-columns:repeat(2,minmax(0,1fr))}}",cs=ge({default:()=>ar,head:()=>or,onGet:()=>nr},1);const nr=({cacheControl:e})=>{e({public:!0,maxAge:900})};var ds=()=>(Ve(N(us,"s_RIE80aAOC7Q")),m("section",null,{class:"home-grid"},[m("div",null,{class:"p-6 surface"},[m("p",null,{class:"text-emerald-300 text-sm uppercase tracking-wide"},y`Performance first`,1,null),m("h1",null,{class:"mt-2 font-semibold text-slate-50 text-3xl"},y`Microscopic first load, big capability`,1,null),m("p",null,{class:"mt-4 text-slate-300"},y`Qwik City SSR keeps the shell light. Navigation is enhanced with View Transitions and Speculation Rules when the browser supports them, and third-party scripts stay off the main thread.`,1,null),m("div",null,{class:"gap-3 grid mt-6 text-slate-200 text-sm"},[m("div",null,{class:"flex items-center gap-2"},y`- Ultra-thin home route with immutable caching`,1,null),m("div",null,{class:"flex items-center gap-2"},y`- Lazy feature routes for store, chat, and AI`,1,null),m("div",null,{class:"flex items-center gap-2"},y`- Optional Partytown for third-party isolation`,1,null)],1,null)],1,null),m("div",null,{class:"p-6 text-slate-200 text-sm surface"},[m("h2",null,{class:"font-semibold text-slate-50 text-lg"},y`Latency budget`,1,null),m("ul",null,{class:"space-y-2 mt-3"},[m("li",null,null,y`Server render: sub-50ms target with streaming enabled`,1,null),m("li",null,null,y`Critical CSS: UnoCSS + Lightning CSS keeps payloads tiny`,1,null),m("li",null,null,y`Speculative nav: prerender store, prefetch chat`,1,null)],1,null)],1,null)],1,"FW_0")),ar=W(N(ds,"s_e7mxYERDQJw"));const or=({withLocale:e})=>e(()=>({title:y`Prometheus | Ultra-fast starter`,meta:[{name:"description",content:y`Qwik City + Bun + Valkey performance stack starter.`}]}));var hs=ge({default:()=>ar,head:()=>or,onGet:()=>nr},1),fs=".ai-island{margin-top:1rem}",ms=async()=>{const[e,t]=le();if(!e.value)return;const r=await fetch("/api/ai/echo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e.value})});if(r.ok){const{echo:i}=await r.json();t.value=i}},ps=()=>{const e=X(""),t=X(""),r=N(ms,"s_rGtr6P02y5w",[e,t]);return m("div",null,{class:"ai-island space-y-3 text-sm text-slate-200"},[m("textarea",null,{value:se(i=>i.value,[e],"p0.value"),class:"w-full rounded-lg border border-slate-800 bg-slate-900 px-3 py-2",placeholder:y`Type a quick prompt`,rows:4,onInput$:Le("s_YrRlW66gD5Y",[e])},null,3,null),m("div",null,{class:"flex items-center gap-2"},[m("button",null,{type:"button",class:"rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-emerald-950",onClick$:r},y`Send to API`,1,null),t.value&&m("span",null,{class:"text-emerald-300"},y`Response: ${t.value}`,1,"9W_0")],1,null)],1,"9W_1")};const gs=W(N(ps,"s_6AcQXlwaGPM"));var ys=ge({default:()=>vs,head:()=>ws},1),bs=()=>(Ve(N(fs,"s_S5uQY9BGXbM")),m("section",null,{class:"surface p-6"},[m("p",null,{class:"text-sm uppercase tracking-wide text-emerald-300"},y`AI tools`,1,null),m("h1",null,{class:"text-2xl font-semibold text-slate-50"},y`Edge-friendly utilities`,1,null),m("p",null,{class:"mt-3 max-w-2xl text-sm text-slate-300"},y`This route keeps the interaction simple: a round-trip echo API that exercises Bun + Elysia without shipping extra client bundles.`,1,null),m("div",null,{onQVisible$:Le("s_08qeP0eGH6U")},z(gs,null,3,"gn_0"),1,null)],1,"gn_1")),vs=W(N(bs,"s_X8xIQqUjebE"));const ws=({withLocale:e})=>e(()=>({title:y`AI | Prometheus`,meta:[{name:"description",content:y`Minimal AI utility route hitting Bun API.`}]}));var Ss=".chat-island{margin-top:1.25rem}.chat-messages{max-height:16rem}",Ps=({cleanup:e})=>{const[t,r,i]=le()},xs=()=>{const[e,t]=le();!e.value||!t.value||(t.value.send(JSON.stringify({type:"chat",text:e.value})),e.value="")},$s=()=>{const e=X([]),t=X(null),r=X(""),i=X(!1);ot(N(Ps,"s_QOX90pOt9sA",[e,i,t]),{eagerness:"visible"});const s=N(xs,"s_0P85XrqKCfY",[r,t]);return m("div",null,{class:"chat-island"},[m("div",null,{class:"mt-4 flex items-center gap-3"},[m("button",null,{type:"button",class:"rounded-lg bg-slate-800 px-3 py-2 text-sm text-slate-100 ring-1 ring-slate-700 transition hover:bg-slate-700",disabled:se(n=>n.value,[i],"p0.value"),onClick$:Le("s_DoKYoyvM41g",[i])},i.value?y`Connected`:y`Connect to chat`,1,null),!i.value&&m("span",null,{class:"text-xs text-slate-400"},y`No socket opened until you opt in.`,1,"Ki_0")],1,null),m("div",null,{class:"mt-5 space-y-3 text-sm text-slate-200"},[m("div",null,{class:"surface chat-messages overflow-auto p-4"},[e.value.length===0&&m("p",null,{class:"text-slate-500"},y`No messages yet.`,1,"Ki_1"),e.value.map(n=>m("div",null,{class:"py-1"},[m("span",null,{class:"text-slate-400"},[te(n,"from"),":"],1,null)," ",m("span",null,null,te(n,"text"),1,null)],1,n.id))],1,null),m("div",null,{class:"flex gap-2"},[m("input",null,{value:se(n=>n.value,[r],"p0.value"),class:"w-full rounded-lg border border-slate-800 bg-slate-900 px-3 py-2 text-slate-100",placeholder:y`Say something quick`,onInput$:Le("s_hgk47q7YSmg",[r])},null,3,null),m("button",null,{type:"button",class:"rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-emerald-950",onClick$:s},y`Send`,1,null)],1,null)],1,null)],1,"Ki_2")};const Ts=W(N($s,"s_54i2tFOIwmo"));var Cs=ge({default:()=>_s,head:()=>As},1),Ns=()=>(Ve(N(Ss,"s_hNgJ6QruKFA")),m("section",null,{class:"surface p-6"},[m("div",null,{class:"flex items-center justify-between gap-2"},[m("div",null,null,[m("p",null,{class:"text-sm uppercase tracking-wide text-emerald-300"},y`Realtime`,1,null),m("h1",null,{class:"text-2xl font-semibold text-slate-50"},y`WebSocket chat via Valkey pub/sub`,1,null)],1,null),m("span",null,{class:"rounded-full bg-slate-800 px-3 py-1 text-xs text-slate-200"},y`websocket`,1,null)],1,null),m("p",null,{class:"mt-3 max-w-2xl text-sm text-slate-300"},y`The client only loads after navigation to keep the home route microscopic. Connect on demand to keep bfcache eligibility until realtime is needed. Messages fan out through Valkey channels on the API.`,1,null),m("div",null,{onQVisible$:Le("s_ELa2ERJwGkM")},z(Ts,null,3,"TX_0"),1,null)],1,"TX_1")),_s=W(N(Ns,"s_uFxaifyy6KQ"));const As=({withLocale:e})=>e(()=>({title:y`Chat | Prometheus`,meta:[{name:"description",content:y`WebSocket chat backed by Valkey pub/sub.`}]}));var Pt=Symbol.for("drizzle:OriginalColumn"),u=Symbol.for("drizzle:entityKind"),Ml=Symbol.for("drizzle:hasOwnEntityKind");function f(e,t){if(!e||typeof e!="object")return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,u))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(e).constructor;if(r)for(;r;){if(u in r&&r[u]===t[u])return!0;r=Object.getPrototypeOf(r)}return!1}var L=class{static[u]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;length;isLengthExact;isAlias;config;table;onInit(){}constructor(e,t){this.config=t,this.onInit(),this.table=e,this.name=t.name,this.isAlias=!1,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity,this.length=t.length,this.isLengthExact=t.isLengthExact}mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}[Pt](){return this}},Ls=class{static[u]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}},he=Symbol.for("drizzle:Name"),qs=class{static[u]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{const{name:r,columns:i,foreignColumns:s}=e();return{name:r,columns:i,foreignTable:s[0].table,foreignColumns:s}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Bs(e,this)}},Bs=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[u]="PgForeignKey";reference;onUpdate;onDelete;name;getName(){const{name:e,columns:t,foreignColumns:r}=this.reference(),i=t.map(o=>o.name),s=r.map(o=>o.name),n=[this.table[he],...i,r[0].table[he],...s];return e??`${n.join("_")}_fk`}isNameExplicit(){return!!this.reference().name}};function Qs(e,...t){return e(...t)}function Bt(e,t,r){for(let i=t;i<e.length;i++){const s=e[i];if(s==="\\"){i++;continue}if(s==='"')return[e.slice(t,i).replace(/\\/g,""),i+1];if(!r&&(s===","||s==="}"))return[e.slice(t,i).replace(/\\/g,""),i]}return[e.slice(t).replace(/\\/g,""),e.length]}function lr(e,t=0){const r=[];let i=t,s=!1;for(;i<e.length;){const n=e[i];if(n===","){(s||i===t)&&r.push(""),s=!0,i++;continue}if(s=!1,n==="\\"){i+=2;continue}if(n==='"'){const[d,c]=Bt(e,i+1,!0);r.push(d),i=c;continue}if(n==="}")return[r,i+1];if(n==="{"){const[d,c]=lr(e,i+1);r.push(d),i=c;continue}const[o,l]=Bt(e,i,!1);r.push(o),i=l}return[r,i]}function Qt(e){const[t]=lr(e,1);return t}function ur(e){return`{${e.map(t=>Array.isArray(t)?ur(t):typeof t=="string"?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}var $=class extends Ls{foreignKeyConfigs=[];static[u]="PgColumnBuilder";array(e){return new Is(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,config:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,config:i})=>Qs((s,n)=>{const o=new qs(()=>{const l=s();return{name:n.name,columns:[e],foreignColumns:[l]}});return n.onUpdate&&o.onUpdate(n.onUpdate),n.onDelete&&o.onDelete(n.onDelete),o.build(t)},r,i))}buildExtraConfigColumn(e){return new ks(e,this.config)}},S=class extends L{static[u]="PgColumn";table;constructor(e,t){super(e,t),this.table=e}},ks=class extends S{static[u]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},Ul=class{static[u]="IndexedColumn";constructor(e,t,r,i){this.name=e,this.keyAsName=t,this.type=r,this.indexConfig=i}name;keyAsName;type;indexConfig},Is=class extends ${static[u]="PgArrayBuilder";constructor(e,t,r){super(e,"array basecolumn","PgArray"),this.config.baseBuilder=t,this.config.length=r}build(e){const t=this.config.baseBuilder.build(e);return new cr(e,this.config,t)}},cr=class dr extends S{constructor(t,r,i,s){super(t,r),this.baseColumn=i,this.range=s}static[u]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.length=="number"?this.length:""}]`}mapFromDriverValue(t){return typeof t=="string"&&(t=Qt(t)),t.map(r=>this.baseColumn.mapFromDriverValue(r))}mapFromJsonValue(t){typeof t=="string"&&(t=Qt(t));const r=this.baseColumn;return"mapFromJsonValue"in r?t.map(i=>r.mapFromJsonValue(i)):t.map(i=>r.mapFromDriverValue(i))}mapToDriverValue(t,r=!1){const i=t.map(s=>s===null?null:f(this.baseColumn,dr)?this.baseColumn.mapToDriverValue(s,!0):this.baseColumn.mapToDriverValue(s));return r?i:ur(i)}},Jl=class extends ${static[u]="PgEnumObjectColumnBuilder";constructor(e,t){super(e,"string enum","PgEnumObjectColumn"),this.config.enum=t}build(e){return new js(e,this.config)}},js=class extends S{static[u]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}},kt=Symbol.for("drizzle:isPgEnum");function Ds(e){return!!e&&typeof e=="function"&&kt in e&&e[kt]===!0}var Kl=class extends ${static[u]="PgEnumColumnBuilder";constructor(e,t){super(e,"string enum","PgEnumColumn"),this.config.enum=t}build(e){return new zs(e,this.config)}},zs=class extends S{static[u]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}},V=class{static[u]="Subquery";constructor(e,t,r,i=!1,s=[]){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:i,usedTables:s}}},hr=class extends V{static[u]="WithSubquery"},q={startActiveSpan(e,t){return t()}},B=Symbol.for("drizzle:ViewBaseConfig"),ae=Symbol.for("drizzle:Schema"),me=Symbol.for("drizzle:Columns"),It=Symbol.for("drizzle:ExtraConfigColumns"),je=Symbol.for("drizzle:OriginalName"),nt=Symbol.for("drizzle:BaseName"),qe=Symbol.for("drizzle:IsAlias"),jt=Symbol.for("drizzle:ExtraConfigBuilder"),Os=Symbol.for("drizzle:IsDrizzleTable"),b=class{static[u]="Table";static Symbol={Name:he,Schema:ae,OriginalName:je,Columns:me,ExtraConfigColumns:It,BaseName:nt,IsAlias:qe,ExtraConfigBuilder:jt};[he];[je];[ae];[me];[It];[nt];[qe]=!1;[Os]=!0;[jt]=void 0;constructor(e,t,r){this[he]=this[je]=e,this[ae]=t,this[nt]=r}};function ne(e){return e[he]}function Oe(e){return`${e[ae]??"public"}.${e[he]}`}var Wl=class{static[u]="FakePrimitiveParam"};function xt(e){return e!=null&&typeof e.getSQL=="function"}function Fs(e){const t={sql:"",params:[]};for(const r of e)t.sql+=r.sql,t.params.push(...r.params),r.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}var F=class{static[u]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new v([this])}},v=class ke{constructor(t){this.queryChunks=t;for(const r of t)if(f(r,b)){const i=r[b.Symbol.Schema];this.usedTables.push(i===void 0?r[b.Symbol.Name]:i+"."+r[b.Symbol.Name])}}static[u]="SQL";decoder=$t;shouldInlineParams=!1;usedTables=[];append(t){return this.queryChunks.push(...t.queryChunks),this}toQuery(t){return q.startActiveSpan("drizzle.buildSQL",r=>{const i=this.buildQueryFromSourceParams(this.queryChunks,t);return r?.setAttributes({"drizzle.query.text":i.sql,"drizzle.query.params":JSON.stringify(i.params)}),i})}buildQueryFromSourceParams(t,r){const i=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:s,escapeName:n,escapeParam:o,prepareTyping:l,inlineParams:d,paramStartIndex:c,invokeSource:p}=i;return Fs(t.map(h=>{if(f(h,F))return{sql:h.value.join(""),params:[]};if(f(h,dt))return{sql:n(h.value),params:[]};if(h===void 0)return{sql:"",params:[]};if(Array.isArray(h)){const g=[new F("(")];for(const[w,A]of h.entries())g.push(A),w<h.length-1&&g.push(new F(", "));return g.push(new F(")")),this.buildQueryFromSourceParams(g,i)}if(f(h,ke))return this.buildQueryFromSourceParams(h.queryChunks,{...i,inlineParams:d||h.shouldInlineParams});if(f(h,b)){const g=h[b.Symbol.Schema],w=h[b.Symbol.Name];return p==="mssql-view-with-schemabinding"?{sql:n(g===void 0?"dbo":g)+"."+n(w),params:[]}:{sql:g===void 0||h[qe]?n(w):n(g)+"."+n(w),params:[]}}if(f(h,L)){const g=s.getColumnCasing(h);if(r.invokeSource==="indexes")return{sql:n(g),params:[]};const w=p==="mssql-check"?void 0:h.table[b.Symbol.Schema];return{sql:h.isAlias?n(h.name):h.table[qe]||w===void 0?n(h.table[b.Symbol.Name])+"."+n(g):n(w)+"."+n(h.table[b.Symbol.Name])+"."+n(g),params:[]}}if(f(h,ye)){const g=h[B].schema,w=h[B].name;return{sql:g===void 0||h[B].isAlias?n(w):n(g)+"."+n(w),params:[]}}if(f(h,pe)){if(f(h.value,xe))return{sql:o(c.value++,h),params:[h],typings:["none"]};const g=h.value===null?null:h.encoder.mapToDriverValue(h.value);if(f(g,ke))return this.buildQueryFromSourceParams([g],i);if(d)return{sql:this.mapInlineParam(g,i),params:[]};let w=["none"];return l&&(w=[l(h.encoder)]),{sql:o(c.value++,g),params:[g],typings:w}}return f(h,xe)?{sql:o(c.value++,h),params:[h],typings:["none"]}:f(h,ke.Aliased)&&h.fieldAlias!==void 0?{sql:n(h.fieldAlias),params:[]}:f(h,V)?h._.isWith?{sql:n(h._.alias),params:[]}:this.buildQueryFromSourceParams([new F("("),h._.sql,new F(") "),new dt(h._.alias)],i):Ds(h)?h.schema?{sql:n(h.schema)+"."+n(h.enumName),params:[]}:{sql:n(h.enumName),params:[]}:xt(h)?h.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([h.getSQL()],i):this.buildQueryFromSourceParams([new F("("),h.getSQL(),new F(")")],i):d?{sql:this.mapInlineParam(h,i),params:[]}:{sql:o(c.value++,h),params:[h],typings:["none"]}}))}mapInlineParam(t,{escapeString:r}){if(t===null)return"null";if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(typeof t=="string")return r(t);if(typeof t=="object"){const i=t.toString();return r(i==="[object Object]"?JSON.stringify(t):i)}throw new Error("Unexpected param value: "+t)}getSQL(){return this}as(t){return t===void 0?this:new ke.Aliased(this,t)}mapWith(t){return this.decoder=typeof t=="function"?{mapFromDriverValue:t}:t,this}inlineParams(){return this.shouldInlineParams=!0,this}if(t){return t?this:void 0}},dt=class{constructor(e){this.value=e}static[u]="Name";brand;getSQL(){return new v([this])}};function Vs(e){return typeof e=="object"&&e!==null&&"mapToDriverValue"in e&&typeof e.mapToDriverValue=="function"}var $t={mapFromDriverValue:e=>e},fr={mapToDriverValue:e=>e},Hl={...$t,...fr},pe=class{constructor(e,t=fr){this.value=e,this.encoder=t}static[u]="Param";brand;getSQL(){return new v([this])}};function a(e,...t){const r=[];(t.length>0||e.length>0&&e[0]!=="")&&r.push(new F(e[0]));for(const[i,s]of t.entries())r.push(s,new F(e[i+1]));return new v(r)}(e=>{function t(){return new v([])}e.empty=t;function r(d){return new v(d)}e.fromList=r;function i(d){return new v([new F(d)])}e.raw=i;function s(d,c){const p=[];for(const[h,g]of d.entries())h>0&&c!==void 0&&p.push(c),p.push(g);return new v(p)}e.join=s;function n(d){return new dt(d)}e.identifier=n;function o(d){return new xe(d)}e.placeholder=o;function l(d,c){return new pe(d,c)}e.param=l})(a||(a={}));(e=>{class t{constructor(i,s){this.sql=i,this.fieldAlias=s}static[u]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new t(this.sql,this.fieldAlias)}}e.Aliased=t})(v||(v={}));var xe=class{constructor(e){this.name=e}static[u]="Placeholder";getSQL(){return new v([this])}};function at(e,t){return e.map(r=>{if(f(r,xe)){if(!(r.name in t))throw new Error(`No value for placeholder "${r.name}" was provided`);return t[r.name]}if(f(r,pe)&&f(r.value,xe)){if(!(r.value.name in t))throw new Error(`No value for placeholder "${r.value.name}" was provided`);return r.encoder.mapToDriverValue(t[r.value.name])}return r})}var Es=Symbol.for("drizzle:IsDrizzleView"),ye=class{static[u]="View";[B];[Es]=!0;get[he](){return this[B].name}get[ae](){return this[B].schema}get[qe](){return this[B].isAlias}get[je](){return this[B].originalName}get[me](){return this[B].selectedFields}constructor({name:e,schema:t,selectedFields:r,query:i}){this[B]={name:e,originalName:e,schema:t,selectedFields:r,query:i,isExisting:!i,isAlias:!1}}};L.prototype.getSQL=function(){return new v([this])};V.prototype.getSQL=function(){return new v([this])};var He=class{constructor(e,t){this.table=e,this.ignoreColumnAlias=t}static[u]="ColumnTableAliasProxyHandler";get(e,t){return t==="table"?this.table:t==="isAlias"&&this.ignoreColumnAlias?!1:e[t]}},Tt=class{constructor(e,t,r){this.alias=e,this.replaceOriginalName=t,this.ignoreColumnAlias=r}static[u]="TableAliasProxyHandler";get(e,t){if(t===b.Symbol.IsAlias)return!0;if(t===b.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===b.Symbol.OriginalName)return this.alias;if(t===B)return{...e[B],name:this.alias,isAlias:!0};if(t===b.Symbol.Columns){const i=e[b.Symbol.Columns];if(!i)return i;const s={};return Object.keys(i).map(n=>{s[n]=new Proxy(i[n],new He(new Proxy(e,this),this.ignoreColumnAlias))}),s}const r=e[t];return f(r,L)?new Proxy(r,new He(new Proxy(e,this),this.ignoreColumnAlias)):r}},Rs=class{constructor(e){this.alias=e}static[u]="ColumnAliasProxyHandler";get(e,t){return t==="isAlias"?!0:t==="name"?this.alias:t==="keyAsName"?!1:t===Pt?()=>e:e[t]}},Gl=class{constructor(e){this.alias=e}static[u]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?ie(e.sourceTable,this.alias):e[t]}};function ie(e,t){return new Proxy(e,new Tt(t,!1,!1))}function Ms(e,t){return new Proxy(e,new Rs(t))}function re(e,t){return new Proxy(e,new He(new Proxy(e.table,new Tt(t,!1,!1)),!1))}function mr(e,t){return new v.Aliased(Ge(e.sql,t),e.fieldAlias)}function Ge(e,t){return a.join(e.queryChunks.map(r=>f(r,L)?re(r,t):f(r,v)?Ge(r,t):f(r,v.Aliased)?mr(r,t):r))}L.prototype.as=function(e){return Ms(this,e)};function Dt(e){return e[Pt]()}var De=class extends Error{static[u]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},Te=class pr extends Error{constructor(t,r,i){super(`Failed query: ${t}
params: ${r}`),this.query=t,this.params=r,this.cause=i,Error.captureStackTrace(this,pr),i&&(this.cause=i)}static[u]="DrizzleQueryError"},Us=class extends De{static[u]="TransactionRollbackError";constructor(){super({message:"Rollback"})}},Js=class{static[u]="ConsoleLogWriter";write(e){console.log(e)}},Ks=class{static[u]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Js}logQuery(e,t){const r=t.map(s=>{try{return JSON.stringify(s)}catch{return String(s)}}),i=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${i}`)}},Ws=class{static[u]="NoopLogger";logQuery(){}},be=class{static[u]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};function Q(e,t){return Vs(t)&&!xt(e)&&!f(e,pe)&&!f(e,xe)&&!f(e,L)&&!f(e,b)&&!f(e,ye)?new pe(e,t):e}var fe=(e,t)=>a`${e} = ${Q(t,e)}`,gr=(e,t)=>a`${e} <> ${Q(t,e)}`;function K(...e){const t=e.filter(r=>r!==void 0);if(t.length!==0)return t.length===1?new v(t):new v([new F("("),a.join(t,new F(" and ")),new F(")")])}function Xe(...e){const t=e.filter(r=>r!==void 0);if(t.length!==0)return t.length===1?new v(t):new v([new F("("),a.join(t,new F(" or ")),new F(")")])}function Ze(e){return a`not ${e}`}var et=(e,t)=>a`${e} > ${Q(t,e)}`,yr=(e,t)=>a`${e} >= ${Q(t,e)}`,br=(e,t)=>a`${e} < ${Q(t,e)}`,vr=(e,t)=>a`${e} <= ${Q(t,e)}`;function wr(e,t){return Array.isArray(t)?t.length===0?a`false`:a`${e} in ${t.map(r=>Q(r,e))}`:a`${e} in ${Q(t,e)}`}function Sr(e,t){return Array.isArray(t)?t.length===0?a`true`:a`${e} not in ${t.map(r=>Q(r,e))}`:a`${e} not in ${Q(t,e)}`}function Pr(e){return a`(${e} is null)`}function xr(e){return a`(${e} is not null)`}function Ct(e){return a`exists ${e}`}function Nt(e){return a`not exists ${e}`}function $r(e,t,r){return a`${e} between ${Q(t,e)} and ${Q(r,e)}`}function Tr(e,t,r){return a`${e} not between ${Q(t,e)} and ${Q(r,e)}`}function Cr(e,t){return a`${e} like ${t}`}function Nr(e,t){return a`${e} not like ${t}`}function _r(e,t){return a`${e} ilike ${t}`}function Ar(e,t){return a`${e} not ilike ${t}`}function Hs(e,t){if(Array.isArray(t)){if(t.length===0)throw new Error("arrayContains requires at least one value");return a`${e} @> ${a`${Q(t,e)}`}`}return a`${e} @> ${Q(t,e)}`}function Gs(e,t){if(Array.isArray(t)){if(t.length===0)throw new Error("arrayContained requires at least one value");return a`${e} <@ ${a`${Q(t,e)}`}`}return a`${e} <@ ${Q(t,e)}`}function Ys(e,t){if(Array.isArray(t)){if(t.length===0)throw new Error("arrayOverlaps requires at least one value");return a`${e} && ${a`${Q(t,e)}`}`}return a`${e} && ${Q(t,e)}`}function ze(e){return a`${e} asc`}function _t(e){return a`${e} desc`}var Lr=class{constructor(e,t){this.targetTableName=t,this.targetTable=e}static[u]="RelationV2";fieldName;sourceColumns;targetColumns;alias;where;sourceTable;targetTable;through;throughTable;isReversed;sourceColumnTableNames=[];targetColumnTableNames=[]},qr=class extends Lr{static[u]="OneV2";relationType="one";optional;constructor(e,t,r,i){super(t,r),this.alias=i?.alias,this.where=i?.where,i?.from&&(this.sourceColumns=(Array.isArray(i.from)?i.from:[i.from]).map(s=>(this.throughTable??=s._.through?e[s._.through._.tableName]:void 0,this.sourceColumnTableNames.push(s._.tableName),s._.column))),i?.to&&(this.targetColumns=(Array.isArray(i.to)?i.to:[i.to]).map(s=>(this.throughTable??=s._.through?e[s._.through._.tableName]:void 0,this.targetColumnTableNames.push(s._.tableName),s._.column))),this.throughTable&&(this.through={source:(Array.isArray(i?.from)?i.from:i?.from?[i.from]:[]).map(s=>s._.through),target:(Array.isArray(i?.to)?i.to:i?.to?[i.to]:[]).map(s=>s._.through)}),this.optional=i?.optional??!0}},Xs=class extends Lr{constructor(e,t,r,i){super(t,r),this.config=i,this.alias=i?.alias,this.where=i?.where,i?.from&&(this.sourceColumns=(Array.isArray(i.from)?i.from:[i.from]).map(s=>(this.throughTable??=s._.through?e[s._.through._.tableName]:void 0,this.sourceColumnTableNames.push(s._.tableName),s._.column))),i?.to&&(this.targetColumns=(Array.isArray(i.to)?i.to:[i.to]).map(s=>(this.throughTable??=s._.through?e[s._.through._.tableName]:void 0,this.targetColumnTableNames.push(s._.tableName),s._.column))),this.throughTable&&(this.through={source:(Array.isArray(i?.from)?i.from:i?.from?[i.from]:[]).map(s=>s._.through),target:(Array.isArray(i?.to)?i.to:i?.to?[i.to]:[]).map(s=>s._.through)})}static[u]="ManyV2";relationType="many"},Zs=class{static[u]="AggregatedField";table;onTable(e){return this.table=e,this}},en=class extends Zs{static[u]="AggregatedFieldCount";query;getSQL(){if(!this.query){if(!this.table)throw new Error("Table must be set before building aggregate field");this.query=a`select count(*) as ${a.identifier("r")} from ${Ae(this.table)}`.mapWith(Number)}return this.query}},Ne={and:K,between:$r,eq:fe,exists:Ct,gt:et,gte:yr,ilike:_r,inArray:wr,arrayContains:Hs,arrayContained:Gs,arrayOverlaps:Ys,isNull:Pr,isNotNull:xr,like:Cr,lt:br,lte:vr,ne:gr,not:Ze,notBetween:Tr,notExists:Nt,notLike:Nr,notIlike:Ar,notInArray:Sr,or:Xe,sql:a},tn={sql:a,asc:ze,desc:_t};function ht(e,t,r=o=>o,i=!1,s=!1,n){for(const o of t){if(o.selection){const p=`${n?`${n}.`:""}${o.key}`;if(e[o.key]===null||i&&(e[o.key]=JSON.parse(e[o.key]),e[o.key]===null))continue;if(s&&typeof e[o.key]=="string"&&(e[o.key]=JSON.parse(e[o.key])),o.isArray){for(const h of e[o.key])ht(h,o.selection,r,!1,s,p);continue}ht(e[o.key],o.selection,r,!1,s,p);continue}const l=o.field,d=r(e[o.key]);if(d===null)continue;let c;f(l,L)?c=l:f(l,v)?c=l.decoder:f(l,v.Aliased)?c=l.sql.decoder:f(l,b)||f(l,ye)?c=$t:c=l.getSQL().decoder,e[o.key]="mapFromJsonValue"in c?c.mapFromJsonValue(d):c.mapFromDriverValue(d)}return e}var Yl=class{static[u]="RelationsBuilderTable";_;constructor(e,t){this._={name:t,table:e}}},Xl=class{static[u]="RelationsBuilderColumn";_;constructor(e,t,r){this._={tableName:t,column:e,key:r}}through(e){return new rn(this._.column,this._.tableName,this._.key,e)}},rn=class{static[u]="RelationsBuilderColumn";_;constructor(e,t,r,i){this._={tableName:t,column:e,through:i,key:r}}},Zl=class{static[u]="RelationsHelperStatic";_;constructor(e){this._={tables:e};const t={},r={};for(const[i,s]of Object.entries(e))t[i]=n=>new qr(e,s,i,n),r[i]=n=>new Xs(e,s,i,n);this.one=t,this.many=r}one;many;aggs={count(){return new en}}};function Br(e,t){const r=e[me][t];return r?f(r,L)?r:f(r,v.Aliased)?a`${e}.${a.identifier(r.fieldAlias)}`:a`${e}.${a.identifier(t)}`:a`${e}.${a.identifier(t)}`}function Ke(e,t){if(typeof t!="object"||f(t,xe))return fe(e,t);const r=Object.entries(t);if(!r.length)return;const i=[];for(const[s,n]of r)if(n!==void 0)switch(s){case"NOT":{const o=Ke(e,n);if(!o)continue;i.push(Ze(o));continue}case"OR":if(!n.length)continue;i.push(Xe(...n.map(o=>Ke(e,o))));continue;case"AND":if(!n.length)continue;i.push(K(...n.map(o=>Ke(e,o))));continue;case"isNotNull":case"isNull":if(!n)continue;i.push(Ne[s](e));continue;case"in":i.push(Ne.inArray(e,n));continue;case"notIn":i.push(Ne.notInArray(e,n));continue;default:i.push(Ne[s](e,n));continue}if(i.length)return K(...i)}function de(e,t,r={},i={},s,n=0){const o=Object.entries(t);if(!o.length)return;const l=[];for(const[d,c]of o)if(c!==void 0)switch(d){case"RAW":{const p=typeof c=="function"?c(e,Ne):c.getSQL();l.push(p);continue}case"OR":if(!c?.length)continue;l.push(Xe(...c.map(p=>de(e,p,r,i,s,n))));continue;case"AND":if(!c?.length)continue;l.push(K(...c.map(p=>de(e,p,r,i,s,n))));continue;case"NOT":{if(c===void 0)continue;const p=de(e,c,r,i,s,n);if(!p)continue;l.push(Ze(p));continue}default:{if(e[me][d]){const _=Ke(Br(e,d),c);_&&l.push(_);continue}const p=r[d];if(!p)throw new De({message:`Unknown relational filter field: "${d}"`});const h=ie(p.targetTable,`f${n}`),g=p.throughTable?ie(p.throughTable,`ft${n}`):void 0,w=i[p.targetTableName],{filter:A,joinCondition:x}=Qr(s,p,e,h,g),C=K(A,typeof c=="boolean"?void 0:de(h,c,w.relations,i,s,n+1)),I=g?a`(select * from ${Ae(h)} inner join ${Ae(g)} on ${x}${a` where ${C}`.if(C)} limit 1)`:a`(select * from ${Ae(h)}${a` where ${C}`.if(C)} limit 1)`;C&&l.push((c?Ct:Nt)(I))}}return K(...l)}function sn(e,t){if(typeof t=="function"){const i=t(e,tn);return f(i,v)?i:Array.isArray(i)?i.length?a.join(i.map(s=>f(s,v)?s:ze(s)),a`, `):void 0:f(i,L)?ze(i):void 0}const r=Object.entries(t).filter(([i,s])=>s);if(r.length)return a.join(r.map(([i,s])=>(s==="asc"?ze:_t)(Br(e,i))),a`, `)}function nn(e,t){const r=[],i=[];for(const[s,n]of Object.entries(t)){if(!n)continue;const o=typeof n=="function"?n(e,{sql:Ne.sql}):n,l=a`(${o.getSQL()}) as ${a.identifier(s)}`;l.decoder=o.getSQL().decoder,r.push(l),i.push({key:s,field:l})}return{sql:r.length?a.join(r,a`, `):void 0,selection:i}}function Qr(e,t,r,i,s){if(t.through){const n=t.sourceColumns.map((l,d)=>{const c=t.through.source[d];return fe(a`${r}.${a.identifier(e.getColumnCasing(l))}`,a`${s}.${a.identifier(f(c._.column,L)?e.getColumnCasing(c._.column):c._.key)}`)}),o=t.targetColumns.map((l,d)=>{const c=t.through.target[d];return fe(a`${s}.${a.identifier(f(c._.column,L)?e.getColumnCasing(c._.column):c._.key)}`,a`${i}.${a.identifier(e.getColumnCasing(l))}`)});return{filter:K(t.where?de(t.isReversed?r:i,t.where):void 0,...n),joinCondition:K(...o)}}return{filter:K(...t.sourceColumns.map((n,o)=>{const l=t.targetColumns[o];return fe(a`${r}.${a.identifier(e.getColumnCasing(n))}`,a`${i}.${a.identifier(e.getColumnCasing(l))}`)}),t.where?de(t.isReversed?r:i,t.where):void 0)}}function Ae(e){return a`${e[qe]?a`${a`${a.identifier(e[ae]??"")}.`.if(e[ae])}${a.identifier(e[je])} as ${e}`:e}`}function an(e,t,r){const i={},s=e.reduce((n,{path:o,field:l},d)=>{let c;f(l,L)?c=l:f(l,v)?c=l.decoder:f(l,V)?c=l._.sql.decoder:c=l.sql.decoder;let p=n;for(const[h,g]of o.entries())if(h<o.length-1)g in p||(p[g]={}),p=p[g];else{const w=t[d],A=p[g]=w===null?null:c.mapFromDriverValue(w);if(r&&f(l,L)&&o.length===2){const x=o[0];x in i?typeof i[x]=="string"&&i[x]!==ne(l.table)&&(i[x]=!1):i[x]=A===null?ne(l.table):!1}}return n},{});if(r&&Object.keys(i).length>0)for(const[n,o]of Object.entries(i))typeof o=="string"&&!r[o]&&(s[n]=null);return s}function $e(e,t){return Object.entries(e).reduce((r,[i,s])=>{if(typeof i!="string")return r;const n=t?[...t,i]:[i];return f(s,L)||f(s,v)||f(s,v.Aliased)||f(s,V)?r.push({path:n,field:s}):f(s,b)?r.push(...$e(s[b.Symbol.Columns],n)):r.push(...$e(s,n)),r},[])}function At(e,t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const[s,n]of r.entries())if(n!==i[s])return!1;return!0}function kr(e,t){const r=Object.entries(t).filter(([,i])=>i!==void 0).map(([i,s])=>f(s,v)||f(s,L)?[i,s]:[i,new pe(s,e[b.Symbol.Columns][i])]);if(r.length===0)throw new Error("No values to set");return Object.fromEntries(r)}function on(e,t){for(const r of t)for(const i of Object.getOwnPropertyNames(r.prototype))i!=="constructor"&&Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(r.prototype,i)||Object.create(null))}function ln(e){return e[b.Symbol.Columns]}function we(e){return f(e,V)?e._.alias:f(e,ye)?e[B].name:f(e,v)?void 0:e[b.Symbol.IsAlias]?e[b.Symbol.Name]:e[b.Symbol.BaseName]}function O(e,t){return{name:typeof e=="string"&&e.length>0?e:"",config:typeof e=="object"?e:t}}var eu=typeof TextDecoder>"u"?null:new TextDecoder,Ee=class extends ${static[u]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){const{name:t,...r}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){const{name:t,...r}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}},un=class extends Ee{static[u]="PgBigInt53Builder";constructor(e){super(e,"number int53","PgBigInt53")}build(e){return new cn(e,this.config)}},cn=class extends S{static[u]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},dn=class extends Ee{static[u]="PgBigInt64Builder";constructor(e){super(e,"bigint int64","PgBigInt64")}build(e){return new hn(e,this.config)}},hn=class extends S{static[u]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}},fn=class extends Ee{static[u]="PgBigIntStringBuilder";constructor(e){super(e,"string int64","PgBigIntString")}build(e){return new mn(e,this.config)}},mn=class extends S{static[u]="PgBigIntString";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="string"?e:String(e)}};function pn(e,t){const{name:r,config:i}=O(e,t);return i.mode==="number"?new un(r):i.mode==="string"?new fn(r):new dn(r)}var gn=class extends ${static[u]="PgBigSerial53Builder";constructor(e){super(e,"number int53","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new yn(e,this.config)}},yn=class extends S{static[u]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},bn=class extends ${static[u]="PgBigSerial64Builder";constructor(e){super(e,"bigint int64","PgBigSerial64"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new vn(e,this.config)}},vn=class extends S{static[u]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}};function wn(e,t){const{name:r,config:i}=O(e,t);return i.mode==="number"?new gn(r):new bn(r)}var Sn=class extends ${static[u]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Pn(e,this.config)}},Pn=class extends S{static[u]="PgBoolean";getSQLType(){return"boolean"}};function xn(e){return new Sn(e??"")}var $n=class extends ${static[u]="PgCharBuilder";constructor(e,t){super(e,t.enum?.length?"string enum":"string","PgChar"),this.config.length=t.length??1,this.config.setLength=t.length!==void 0,this.config.enumValues=t.enum}build(e){return new Tn(e,this.config)}},Tn=class extends S{static[u]="PgChar";enumValues=this.config.enumValues;getSQLType(){return this.config.setLength?`char(${this.length})`:"char"}};function Cn(e,t={}){const{name:r,config:i}=O(e,t);return new $n(r,i)}var Nn=class extends ${static[u]="PgCidrBuilder";constructor(e){super(e,"string cidr","PgCidr")}build(e){return new _n(e,this.config)}},_n=class extends S{static[u]="PgCidr";getSQLType(){return"cidr"}};function An(e){return new Nn(e??"")}var Ln=class extends ${static[u]="PgCustomColumnBuilder";constructor(e,t,r){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new qn(e,this.config)}},qn=class extends S{static[u]="PgCustomColumn";sqlName;mapTo;mapFrom;mapJson;forJsonSelect;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver,this.mapJson=t.customTypeParams.fromJson,this.forJsonSelect=t.customTypeParams.forJsonSelect}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapFromJsonValue(e){return typeof this.mapJson=="function"?this.mapJson(e):this.mapFromDriverValue(e)}jsonSelectIdentifier(e,t,r){if(typeof this.forJsonSelect=="function")return this.forJsonSelect(e,t,r);const i=this.getSQLType().toLowerCase(),s=i.indexOf("(");switch(s+1?i.slice(0,s):i){case"bytea":case"geometry":case"timestamp":case"numeric":case"bigint":{const n="[]".repeat(r??0);return t`${e}::text${t.raw(n).if(r)}`}default:return e}}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}};function Bn(e){return(t,r)=>{const{name:i,config:s}=O(t,r);return new Ln(i,s,e)}}var Re=class extends ${static[u]="PgDateColumnBaseBuilder";defaultNow(){return this.default(a`now()`)}},Qn=class extends Re{static[u]="PgDateBuilder";constructor(e){super(e,"object date","PgDate")}build(e){return new Ir(e,this.config)}},Ir=class extends S{static[u]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return typeof e=="string"?new Date(e):e}mapToDriverValue(e){return typeof e=="string"?e:e.toISOString()}},kn=class extends Re{static[u]="PgDateStringBuilder";constructor(e){super(e,"string date","PgDateString")}build(e){return new jr(e,this.config)}},jr=class extends S{static[u]="PgDateString";getSQLType(){return"date"}mapFromDriverValue(e){return typeof e=="string"?e:e.toISOString().slice(0,-14)}mapToDriverValue(e){return typeof e=="string"?e:e.toISOString()}};function In(e,t){const{name:r,config:i}=O(e,t);return i?.mode==="date"?new Qn(r):new kn(r)}var jn=class extends ${static[u]="PgDoublePrecisionBuilder";constructor(e){super(e,"number double","PgDoublePrecision")}build(e){return new Dn(e,this.config)}},Dn=class extends S{static[u]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}};function zn(e){return new jn(e??"")}var On=class extends ${static[u]="PgInetBuilder";constructor(e){super(e,"string inet","PgInet")}build(e){return new Fn(e,this.config)}},Fn=class extends S{static[u]="PgInet";getSQLType(){return"inet"}};function Vn(e){return new On(e??"")}var En=class extends Ee{static[u]="PgIntegerBuilder";constructor(e){super(e,"number int32","PgInteger")}build(e){return new Rn(e,this.config)}},Rn=class extends S{static[u]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};function Mn(e){return new En(e??"")}var Un=class extends ${static[u]="PgIntervalBuilder";constructor(e,t){super(e,"string interval","PgInterval"),this.config.intervalConfig=t}build(e){return new Jn(e,this.config)}},Jn=class extends S{static[u]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){return`interval${this.fields?` ${this.fields}`:""}${this.precision?`(${this.precision})`:""}`}};function Kn(e,t={}){const{name:r,config:i}=O(e,t);return new Un(r,i)}var Wn=class extends ${static[u]="PgJsonBuilder";constructor(e){super(e,"object json","PgJson")}build(e){return new Dr(e,this.config)}},Dr=class extends S{static[u]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Hn(e){return new Wn(e??"")}var Gn=class extends ${static[u]="PgJsonbBuilder";constructor(e){super(e,"object json","PgJsonb")}build(e){return new zr(e,this.config)}},zr=class extends S{static[u]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Yn(e){return new Gn(e??"")}var Xn=class extends ${static[u]="PgLineBuilder";constructor(e){super(e,"array line","PgLine")}build(e){return new Zn(e,this.config)}},Zn=class extends S{static[u]="PgLine";mode="tuple";getSQLType(){return"line"}mapFromDriverValue(e){const[t,r,i]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},ea=class extends ${static[u]="PgLineABCBuilder";constructor(e){super(e,"object line","PgLineABC")}build(e){return new ta(e,this.config)}},ta=class extends S{static[u]="PgLineABC";mode="abc";getSQLType(){return"line"}mapFromDriverValue(e){const[t,r,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(r),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}};function ra(e,t){const{name:r,config:i}=O(e,t);return!i?.mode||i.mode==="tuple"?new Xn(r):new ea(r)}var ia=class extends ${static[u]="PgMacaddrBuilder";constructor(e){super(e,"string macaddr","PgMacaddr")}build(e){return new sa(e,this.config)}},sa=class extends S{static[u]="PgMacaddr";getSQLType(){return"macaddr"}};function na(e){return new ia(e??"")}var aa=class extends ${static[u]="PgMacaddr8Builder";constructor(e){super(e,"string macaddr8","PgMacaddr8")}build(e){return new oa(e,this.config)}},oa=class extends S{static[u]="PgMacaddr8";getSQLType(){return"macaddr8"}};function la(e){return new aa(e??"")}var ua=class extends ${static[u]="PgNumericBuilder";constructor(e,t,r){super(e,"string numeric","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new Or(e,this.config)}},Or=class extends S{static[u]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return typeof e=="string"?e:String(e)}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}},ca=class extends ${static[u]="PgNumericNumberBuilder";constructor(e,t,r){super(e,"number","PgNumericNumber"),this.config.precision=t,this.config.scale=r}build(e){return new da(e,this.config)}},da=class extends S{static[u]="PgNumericNumber";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}mapToDriverValue=String;getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}},ha=class extends ${static[u]="PgNumericBigIntBuilder";constructor(e,t,r){super(e,"bigint int64","PgNumericBigInt"),this.config.precision=t,this.config.scale=r}build(e){return new fa(e,this.config)}},fa=class extends S{static[u]="PgNumericBigInt";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};function ma(e,t){const{name:r,config:i}=O(e,t),s=i?.mode;return s==="number"?new ca(r,i?.precision,i?.scale):s==="bigint"?new ha(r,i?.precision,i?.scale):new ua(r,i?.precision,i?.scale)}var pa=class extends ${static[u]="PgPointTupleBuilder";constructor(e){super(e,"array point","PgPointTuple")}build(e){return new ga(e,this.config)}},ga=class extends S{static[u]="PgPointTuple";mode="tuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[t,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},ya=class extends ${static[u]="PgPointObjectBuilder";constructor(e){super(e,"object point","PgPointObject")}build(e){return new ba(e,this.config)}},ba=class extends S{static[u]="PgPointObject";mode="xy";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[t,r]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(r)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}};function va(e,t){const{name:r,config:i}=O(e,t);return!i?.mode||i.mode==="tuple"?new pa(r):new ya(r)}function wa(e){const t=[];for(let r=0;r<e.length;r+=2)t.push(Number.parseInt(e.slice(r,r+2),16));return new Uint8Array(t)}function zt(e,t){const r=new ArrayBuffer(8),i=new DataView(r);for(let s=0;s<8;s++)i.setUint8(s,e[t+s]);return i.getFloat64(0,!0)}function Fr(e){const t=wa(e);let r=0;const i=t[r];r+=1;const s=new DataView(t.buffer),n=s.getUint32(r,i===1);r+=4;let o;if(n&536870912&&(o=s.getUint32(r,i===1),r+=4),(n&65535)===1){const l=zt(t,r);r+=8;const d=zt(t,r);return r+=8,{srid:o,point:[l,d]}}throw new Error("Unsupported geometry type")}var Sa=class extends ${static[u]="PgGeometryBuilder";constructor(e,t){super(e,"array geometry","PgGeometry"),this.config.srid=t}build(e){return new Pa(e,this.config)}},Pa=class extends S{static[u]="PgGeometry";srid=this.config.srid;mode="tuple";getSQLType(){return`geometry(point${this.srid===void 0?"":`,${this.srid}`})`}mapFromDriverValue(e){return typeof e!="string"?e:Fr(e).point}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},xa=class extends ${static[u]="PgGeometryObjectBuilder";constructor(e,t){super(e,"object geometry","PgGeometryObject"),this.config.srid=t}build(e){return new $a(e,this.config)}},$a=class extends S{static[u]="PgGeometryObject";srid=this.config.srid;mode="object";getSQLType(){return`geometry(point${this.srid===void 0?"":`,${this.srid}`})`}mapFromDriverValue(e){const t=Fr(e);return{x:t.point[0],y:t.point[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}};function Ta(e,t){const{name:r,config:i}=O(e,t);return!i?.mode||i.mode==="tuple"?new Sa(r,i?.srid):new xa(r,i?.srid)}var Ca=class extends ${static[u]="PgRealBuilder";constructor(e,t){super(e,"number float","PgReal"),this.config.length=t}build(e){return new Na(e,this.config)}},Na=class extends S{static[u]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e};function _a(e){return new Ca(e??"")}var Aa=class extends ${static[u]="PgSerialBuilder";constructor(e){super(e,"number int32","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new La(e,this.config)}},La=class extends S{static[u]="PgSerial";getSQLType(){return"serial"}};function qa(e){return new Aa(e??"")}var Ba=class extends Ee{static[u]="PgSmallIntBuilder";constructor(e){super(e,"number int16","PgSmallInt")}build(e){return new Qa(e,this.config)}},Qa=class extends S{static[u]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e};function ka(e){return new Ba(e??"")}var Ia=class extends ${static[u]="PgSmallSerialBuilder";constructor(e){super(e,"number int16","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new ja(e,this.config)}},ja=class extends S{static[u]="PgSmallSerial";getSQLType(){return"smallserial"}};function Da(e){return new Ia(e??"")}var za=class extends ${static[u]="PgTextBuilder";constructor(e,t){super(e,t.enum?.length?"string enum":"string","PgText"),this.config.enumValues=t.enum}build(e){return new Oa(e,this.config,this.config.enumValues)}},Oa=class extends S{static[u]="PgText";enumValues;constructor(e,t,r){super(e,t),this.enumValues=r}getSQLType(){return"text"}};function Fa(e,t={}){const{name:r,config:i}=O(e,t);return new za(r,i)}var Va=class extends Re{constructor(e,t,r){super(e,"string time","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}static[u]="PgTimeBuilder";build(e){return new Vr(e,this.config)}},Vr=class extends S{static[u]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function Ea(e,t={}){const{name:r,config:i}=O(e,t);return new Va(r,i.withTimezone??!1,i.precision)}var Ra=class extends Re{static[u]="PgTimestampBuilder";constructor(e,t,r){super(e,"object date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new Er(e,this.config)}},Er=class extends S{static[u]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue(e){return typeof e=="string"?new Date(this.withTimezone?e:e+"+0000"):e}mapToDriverValue(e){return typeof e=="string"?e:e.toISOString()}},Ma=class extends Re{static[u]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string timestamp","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new Rr(e,this.config)}},Rr=class extends S{static[u]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue(e){if(typeof e=="string")return e;const t=e.toISOString().slice(0,-1).replace("T"," ");if(this.withTimezone){const r=e.getTimezoneOffset();return`${t}${r<=0?"+":"-"}${Math.floor(Math.abs(r)/60).toString().padStart(2,"0")}`}return t}mapToDriverValue(e){return typeof e=="string"?e:e.toISOString()}};function Ua(e,t={}){const{name:r,config:i}=O(e,t);return i?.mode==="string"?new Ma(r,i.withTimezone??!1,i.precision):new Ra(r,i?.withTimezone??!1,i?.precision)}var Ja=class extends ${static[u]="PgUUIDBuilder";constructor(e){super(e,"string uuid","PgUUID")}defaultRandom(){return this.default(a`gen_random_uuid()`)}build(e){return new Mr(e,this.config)}},Mr=class extends S{static[u]="PgUUID";getSQLType(){return"uuid"}};function Ka(e){return new Ja(e??"")}var Wa=class extends ${static[u]="PgVarcharBuilder";constructor(e,t){super(e,t.enum?.length?"string enum":"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Ha(e,this.config)}},Ha=class extends S{static[u]="PgVarchar";enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};function Ga(e,t={}){const{name:r,config:i}=O(e,t);return new Wa(r,i)}var Ya=class extends ${static[u]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string binary","PgBinaryVector"),this.config.length=t.dimensions,this.config.isLengthExact=!0}build(e){return new Xa(e,this.config)}},Xa=class extends S{static[u]="PgBinaryVector";getSQLType(){return`bit(${this.length})`}};function Za(e,t){const{name:r,config:i}=O(e,t);return new Ya(r,i)}var eo=class extends ${static[u]="PgHalfVectorBuilder";constructor(e,t){super(e,"array halfvector","PgHalfVector"),this.config.length=t.dimensions,this.config.isLengthExact=!0}build(e){return new to(e,this.config)}},to=class extends S{static[u]="PgHalfVector";getSQLType(){return`halfvec(${this.length})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function ro(e,t){const{name:r,config:i}=O(e,t);return new eo(r,i)}var io=class extends ${static[u]="PgSparseVectorBuilder";constructor(e,t){super(e,"string sparsevec","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new so(e,this.config)}},so=class extends S{static[u]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}};function no(e,t){const{name:r,config:i}=O(e,t);return new io(r,i)}var ao=class extends ${static[u]="PgVectorBuilder";constructor(e,t){super(e,"array vector","PgVector"),this.config.length=t.dimensions,this.config.isLengthExact=!0}build(e){return new oo(e,this.config)}},oo=class extends S{static[u]="PgVector";getSQLType(){return`vector(${this.length})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function lo(e,t){const{name:r,config:i}=O(e,t);return new ao(r,i)}function uo(){return{bigint:pn,bigserial:wn,boolean:xn,char:Cn,cidr:An,customType:Bn,date:In,doublePrecision:zn,inet:Vn,integer:Mn,interval:Kn,json:Hn,jsonb:Yn,line:ra,macaddr:na,macaddr8:la,numeric:ma,point:va,geometry:Ta,real:_a,serial:qa,smallint:ka,smallserial:Da,text:Fa,time:Ea,timestamp:Ua,uuid:Ka,varchar:Ga,bit:Za,halfvec:ro,sparsevec:no,vector:lo}}var ft=Symbol.for("drizzle:PgInlineForeignKeys"),mt=Symbol.for("drizzle:EnableRLS"),R=class extends b{static[u]="PgTable";static Symbol=Object.assign({},b.Symbol,{InlineForeignKeys:ft,EnableRLS:mt});[ft]=[];[mt]=!1;[b.Symbol.ExtraConfigBuilder]=void 0;[b.Symbol.ExtraConfigColumns]={}};function Ur(e,t,r,i,s=e){const n=new R(e,i,s),o=typeof t=="function"?t(uo()):t,l=Object.fromEntries(Object.entries(o).map(([p,h])=>{const g=h;g.setName(p);const w=g.build(n);return n[ft].push(...g.buildForeignKeys(w,n)),[p,w]})),d=Object.fromEntries(Object.entries(o).map(([p,h])=>{const g=h;return g.setName(p),[p,g.buildExtraConfigColumn(n)]})),c=Object.assign(n,l);return c[b.Symbol.Columns]=l,c[b.Symbol.ExtraConfigColumns]=d,r&&(c[R.Symbol.ExtraConfigBuilder]=r),Object.assign(c,{enableRLS:()=>(c[R.Symbol.EnableRLS]=!0,c)})}var co=(e,t,r)=>Ur(e,t,r,void 0),ho=(e,t,r)=>{const i=Ur(e,t,r,void 0);return i[mt]=!0,i},tu=Object.assign(co,{withRLS:ho}),fo=class{static[u]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new mo(e,this.columns,this.name)}},mo=class{constructor(e,t,r){this.table=e,this.columns=t,this.name=r,this.isNameExplicit=!!r}static[u]="PgPrimaryKey";columns;name;isNameExplicit;getName(){return this.name??`${this.table[R.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}},Jr=class{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[b.Symbol.Name]}static[u]="Relation";referencedTableName;fieldName},po=class{constructor(e,t){this.table=e,this.config=t}static[u]="Relations"},Fe=class Kr extends Jr{constructor(t,r,i,s){super(t,r,i?.relationName),this.config=i,this.isNullable=s}static[u]="One";withFieldName(t){const r=new Kr(this.sourceTable,this.referencedTable,this.config,this.isNullable);return r.fieldName=t,r}},Wr=class Hr extends Jr{constructor(t,r,i){super(t,r,i?.relationName),this.config=i}static[u]="Many";withFieldName(t){const r=new Hr(this.sourceTable,this.referencedTable,this.config);return r.fieldName=t,r}};function go(){return{and:K,between:$r,eq:fe,exists:Ct,gt:et,gte:yr,ilike:_r,inArray:wr,isNull:Pr,isNotNull:xr,like:Cr,lt:br,lte:vr,ne:gr,not:Ze,notBetween:Tr,notExists:Nt,notLike:Nr,notIlike:Ar,notInArray:Sr,or:Xe,sql:a}}function yo(){return{sql:a,asc:ze,desc:_t}}function bo(e,t){Object.keys(e).length===1&&"default"in e&&!f(e.default,b)&&(e=e.default);const r={},i={},s={};for(const[n,o]of Object.entries(e))if(f(o,b)){const l=Oe(o),d=i[l];r[l]=n,s[n]={tsName:n,dbName:o[b.Symbol.Name],schema:o[b.Symbol.Schema],columns:o[b.Symbol.Columns],relations:d?.relations??{},primaryKey:d?.primaryKey??[]};for(const p of Object.values(o[b.Symbol.Columns]))p.primary&&s[n].primaryKey.push(p);const c=o[b.Symbol.ExtraConfigBuilder]?.(o[b.Symbol.ExtraConfigColumns]);if(c)for(const p of Object.values(c))f(p,fo)&&s[n].primaryKey.push(...p.columns)}else if(f(o,po)){const l=Oe(o.table),d=r[l],c=o.config(t(o.table));for(const[p,h]of Object.entries(c))if(d){const g=s[d];g.relations[p]=h}else l in i||(i[l]={relations:{}}),i[l].relations[p]=h}return{tables:s,tableNamesMap:r}}function vo(e){return function(r,i){return new Fe(e,r,i,i?.fields.reduce((s,n)=>s&&n.notNull,!0)??!1)}}function wo(e){return function(r,i){return new Wr(e,r,i)}}function So(e,t,r){if(f(r,Fe)&&r.config)return{fields:r.config.fields,references:r.config.references};const i=t[Oe(r.referencedTable)];if(!i)throw new Error(`Table "${r.referencedTable[b.Symbol.Name]}" not found in schema`);const s=e[i];if(!s)throw new Error(`Table "${i}" not found in schema`);const n=r.sourceTable,o=t[Oe(n)];if(!o)throw new Error(`Table "${n[b.Symbol.Name]}" not found in schema`);const l=[];for(const d of Object.values(s.relations))(r.relationName&&r!==d&&d.relationName===r.relationName||!r.relationName&&d.referencedTable===r.sourceTable)&&l.push(d);if(l.length>1)throw r.relationName?new Error(`There are multiple relations with name "${r.relationName}" in table "${i}"`):new Error(`There are multiple relations between "${i}" and "${r.sourceTable[b.Symbol.Name]}". Please specify relation name`);if(l[0]&&f(l[0],Fe)&&l[0].config)return{fields:l[0].config.references,references:l[0].config.fields};throw new Error(`There is not enough information to infer relation "${o}.${r.fieldName}"`)}function Po(e){return{one:vo(e),many:wo(e)}}function pt(e,t,r,i,s=n=>n){const n={};for(const[o,l]of i.entries())if(l.isJson){const d=t.relations[l.tsKey],c=r[o],p=typeof c=="string"?JSON.parse(c):c;n[l.tsKey]=f(d,Fe)?p&&pt(e,e[l.relationTableTsKey],p,l.selection,s):p.map(h=>pt(e,e[l.relationTableTsKey],h,l.selection,s))}else{const d=s(r[o]),c=l.field;let p;f(c,L)?p=c:f(c,v)?p=c.decoder:p=c.sql.decoder,n[l.tsKey]=d===null?null:p.mapFromDriverValue(d)}return n}var M=class Gr{static[u]="SelectionProxyHandler";config;constructor(t){this.config={...t}}get(t,r){if(r==="_")return{...t._,selectedFields:new Proxy(t._.selectedFields,this)};if(r===B)return{...t[B],selectedFields:new Proxy(t[B].selectedFields,this)};if(typeof r=="symbol")return t[r];const i=(f(t,V)?t._.selectedFields:f(t,ye)?t[B].selectedFields:t)[r];if(f(i,v.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!i.isSelectionField)return i.sql;const s=i.clone();return s.isSelectionField=!0,s}if(f(i,v)){if(this.config.sqlBehavior==="sql")return i;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return f(i,L)?this.config.alias?new Proxy(i,new He(new Proxy(i.table,new Tt(this.config.alias,this.config.replaceOriginalName??!1,!0)),!0)):i:typeof i!="object"||i===null?i:new Proxy(i,new Gr(this.config))}};function Pe(e){return f(e,R)?[e[ae]?`${e[ae]}.${e[b.Symbol.BaseName]}`:e[b.Symbol.BaseName]]:f(e,V)?e._.usedTables??[]:f(e,v)?e.usedTables??[]:[]}var Ot=class extends be{constructor(e,t,r,i){super(),this.session=t,this.dialect=r,this.config={table:e,withList:i}}static[u]="PgDelete";config;cacheConfig;where(e){return this.config.where=e,this}returning(e=this.config.table[b.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=$e(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return q.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"delete",tables:Pe(this.config.table)},this.cacheConfig))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>q.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new M({alias:ne(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};function xo(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function $o(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,r,i)=>t+(i===0?r.toLowerCase():`${r[0].toUpperCase()}${r.slice(1)}`),"")}function To(e){return e}var Co=class{static[u]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?xo:e==="camelCase"?$o:To}getColumnCasing(e){if(!e.keyAsName)return e.name;const t=`${e.table[b.Symbol.Schema]??"public"}.${e.table[b.Symbol.OriginalName]}.${e.name}`;return this.cache[t]||this.cacheTable(e.table),this.cache[t]}cacheTable(e){const t=`${e[b.Symbol.Schema]??"public"}.${e[b.Symbol.OriginalName]}`;if(!this.cachedTables[t]){for(const r of Object.values(e[b.Symbol.Columns])){if(!f(r,L))continue;const i=`${t}.${r.name}`;this.cache[i]=this.convert(r.name)}this.cachedTables[t]=!0}}clearCache(){this.cache={},this.cachedTables={}}},Yr=class extends ye{static[u]="PgViewBase"},We=class{static[u]="PgDialect";casing;constructor(e){this.casing=new Co(e?.casing)}async migrate(e,t,r){const i=typeof r=="string"?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",s=typeof r=="string"?"drizzle":r.migrationsSchema??"drizzle",n=a`
			CREATE TABLE IF NOT EXISTS ${a.identifier(s)}.${a.identifier(i)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(a`CREATE SCHEMA IF NOT EXISTS ${a.identifier(s)}`),await t.execute(n);const o=await t.all(a`select id, hash, created_at from ${a.identifier(s)}.${a.identifier(i)} order by created_at desc limit 1`);if(typeof r=="object"&&r.init){if(o.length)return{exitCode:"databaseMigrations"};if(e.length>1)return{exitCode:"localMigrations"};const[d]=e;if(!d)return;await t.execute(a`insert into ${a.identifier(s)}.${a.identifier(i)} ("hash", "created_at") values(${d.hash}, ${d.folderMillis})`);return}const l=o[0];await t.transaction(async d=>{for await(const c of e)if(!l||Number(l.created_at)<c.folderMillis){for(const p of c.sql)await d.execute(a.raw(p));await d.execute(a`insert into ${a.identifier(s)}.${a.identifier(i)} ("hash", "created_at") values(${c.hash}, ${c.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;const t=[a`with `];for(const[r,i]of e.entries())t.push(a`${a.identifier(i._.alias)} as (${i._.sql})`),r<e.length-1&&t.push(a`, `);return t.push(a` `),a.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:i}){const s=this.buildWithCTE(i),n=r?a` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0;return a`${s}delete from ${e}${t?a` where ${t}`:void 0}${n}`}buildUpdateSet(e,t){const r=e[b.Symbol.Columns],i=Object.keys(r).filter(n=>t[n]!==void 0||r[n]?.onUpdateFn!==void 0),s=i.length;return a.join(i.flatMap((n,o)=>{const l=r[n],d=l.onUpdateFn?.(),c=t[n]??(f(d,v)?d:a.param(d,l)),p=a`${a.identifier(this.casing.getColumnCasing(l))} = ${c}`;return o<s-1?[p,a.raw(", ")]:[p]}))}buildUpdateQuery({table:e,set:t,where:r,returning:i,withList:s,from:n,joins:o}){const l=this.buildWithCTE(s),d=e[R.Symbol.Name],c=e[R.Symbol.Schema],p=e[R.Symbol.OriginalName],h=d===p?void 0:d,g=a`${c?a`${a.identifier(c)}.`:void 0}${a.identifier(p)}${h&&a` ${a.identifier(h)}`}`,w=this.buildUpdateSet(e,t),A=n&&a.join([a.raw(" from "),this.buildFromTable(n)]),x=this.buildJoins(o),C=i?a` returning ${this.buildSelection(i,{isSingleTable:!n})}`:void 0;return a`${l}update ${g} set ${w}${A}${x}${r?a` where ${r}`:void 0}${C}`}buildSelection(e,{isSingleTable:t=!1}={}){const r=e.length,i=e.flatMap(({field:s},n)=>{const o=[];if(f(s,v.Aliased)&&s.isSelectionField)o.push(a.identifier(s.fieldAlias));else if(f(s,v.Aliased)||f(s,v)){const l=f(s,v.Aliased)?s.sql:s;t?o.push(new v(l.queryChunks.map(d=>f(d,S)?a.identifier(this.casing.getColumnCasing(d)):d))):o.push(l),f(s,v.Aliased)&&o.push(a` as ${a.identifier(s.fieldAlias)}`)}else if(f(s,L))t?o.push(s.isAlias?a`${a.identifier(this.casing.getColumnCasing(Dt(s)))} as ${s}`:a.identifier(this.casing.getColumnCasing(s))):o.push(s.isAlias?a`${Dt(s)} as ${s}`:s);else if(f(s,V)){const l=Object.entries(s._.selectedFields);if(l.length===1){const d=l[0][1],c=f(d,v)?d.decoder:f(d,L)?{mapFromDriverValue:p=>d.mapFromDriverValue(p)}:d.sql.decoder;c&&(s._.sql.decoder=c)}o.push(s)}return n<r-1&&o.push(a`, `),o});return a.join(i)}buildJoins(e){if(!e||e.length===0)return;const t=[];for(const[r,i]of e.entries()){r===0&&t.push(a` `);const s=i.table,n=i.lateral?a` lateral`:void 0,o=i.on?a` on ${i.on}`:void 0;if(f(s,R)){const l=s[R.Symbol.Name],d=s[R.Symbol.Schema],c=s[R.Symbol.OriginalName],p=l===c?void 0:i.alias;t.push(a`${a.raw(i.joinType)} join${n} ${d?a`${a.identifier(d)}.`:void 0}${a.identifier(c)}${p&&a` ${a.identifier(p)}`}${o}`)}else if(f(s,ye)){const l=s[B].name,d=s[B].schema,c=s[B].originalName,p=l===c?void 0:i.alias;t.push(a`${a.raw(i.joinType)} join${n} ${d?a`${a.identifier(d)}.`:void 0}${a.identifier(c)}${p&&a` ${a.identifier(p)}`}${o}`)}else t.push(a`${a.raw(i.joinType)} join${n} ${s}${o}`);r<e.length-1&&t.push(a` `)}return a.join(t)}buildFromTable(e){if(f(e,b)&&e[b.Symbol.IsAlias]){let t=a`${a.identifier(e[b.Symbol.OriginalName])}`;return e[b.Symbol.Schema]&&(t=a`${a.identifier(e[b.Symbol.Schema])}.${t}`),a`${t} ${a.identifier(e[b.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:i,having:s,table:n,joins:o,orderBy:l,groupBy:d,limit:c,offset:p,lockingClause:h,distinct:g,setOperators:w}){const A=r??$e(t);for(const D of A)if(f(D.field,L)&&ne(D.field.table)!==(f(n,V)?n._.alias:f(n,Yr)?n[B].name:f(n,v)?void 0:ne(n))&&!(ee=>o?.some(({alias:Qe})=>Qe===(ee[b.Symbol.IsAlias]?ne(ee):ee[b.Symbol.BaseName])))(D.field.table)){const ee=ne(D.field.table);throw new Error(`Your "${D.path.join("->")}" field references a column "${ee}"."${D.field.name}", but the table "${ee}" is not part of the query! Did you forget to join it?`)}const x=!o||o.length===0,C=this.buildWithCTE(e);let I;g&&(I=g===!0?a` distinct`:a` distinct on (${a.join(g.on,a`, `)})`);const _=this.buildSelection(A,{isSingleTable:x}),U=this.buildFromTable(n),k=this.buildJoins(o),E=i?a` where ${i}`:void 0,P=s?a` having ${s}`:void 0;let T;l&&l.length>0&&(T=a` order by ${a.join(l,a`, `)}`);let j;d&&d.length>0&&(j=a` group by ${a.join(d,a`, `)}`);const Z=typeof c=="object"||typeof c=="number"&&c>=0?a` limit ${c}`:void 0,J=p?a` offset ${p}`:void 0,H=a.empty();if(h){const D=a` for ${a.raw(h.strength)}`;h.config.of&&D.append(a` of ${a.join(Array.isArray(h.config.of)?h.config.of:[h.config.of],a`, `)}`),h.config.noWait?D.append(a` nowait`):h.config.skipLocked&&D.append(a` skip locked`),H.append(D)}const ue=a`${C}select${I} ${_} from ${U}${k}${E}${j}${P}${T}${Z}${J}${H}`;return w.length>0?this.buildSetOperations(ue,w):ue}buildSetOperations(e,t){const[r,...i]=t;if(!r)throw new Error("Cannot pass undefined values to any set operator");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:i,limit:s,orderBy:n,offset:o}}){const l=a`(${e.getSQL()}) `,d=a`(${i.getSQL()})`;let c;if(n&&n.length>0){const w=[];for(const A of n)if(f(A,S))w.push(a.identifier(A.name));else if(f(A,v)){for(let x=0;x<A.queryChunks.length;x++){const C=A.queryChunks[x];f(C,S)&&(A.queryChunks[x]=a.identifier(C.name))}w.push(a`${A}`)}else w.push(a`${A}`);c=a` order by ${a.join(w,a`, `)} `}const p=typeof s=="object"||typeof s=="number"&&s>=0?a` limit ${s}`:void 0,h=a.raw(`${t} ${r?"all ":""}`),g=o?a` offset ${o}`:void 0;return a`${l}${h}${d}${c}${p}${g}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:i,withList:s,select:n,overridingSystemValue_:o}){const l=[],d=e[b.Symbol.Columns],c=Object.entries(d).filter(([x,C])=>!C.shouldDisableInsert()),p=c.map(([,x])=>a.identifier(this.casing.getColumnCasing(x)));if(n){const x=t;f(x,v)?l.push(x):l.push(x.getSQL())}else{const x=t;l.push(a.raw("values "));for(const[C,I]of x.entries()){const _=[];for(const[U,k]of c){const E=I[U];if(E===void 0||f(E,pe)&&E.value===void 0)if(k.defaultFn!==void 0){const P=k.defaultFn(),T=f(P,v)?P:a.param(P,k);_.push(T)}else if(!k.default&&k.onUpdateFn!==void 0){const P=k.onUpdateFn(),T=f(P,v)?P:a.param(P,k);_.push(T)}else _.push(a`default`);else _.push(E)}l.push(_),C<x.length-1&&l.push(a`, `)}}const h=this.buildWithCTE(s),g=a.join(l),w=i?a` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,A=r?a` on conflict ${r}`:void 0;return a`${h}insert into ${e} ${p} ${o===!0?a`overriding system value `:void 0}${g}${A}${w}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:r}){return a`refresh materialized view${t?a` concurrently`:void 0} ${e}${r?a` with no data`:void 0}`}prepareTyping(e){return f(e,zr)||f(e,Dr)?"json":f(e,Or)?"decimal":f(e,Vr)?"time":f(e,Er)||f(e,Rr)?"timestamp":f(e,Ir)||f(e,jr)?"date":f(e,Mr)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}_buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:r,table:i,tableConfig:s,queryConfig:n,tableAlias:o,nestedQueryRelation:l,joinOn:d}){let c=[],p,h,g=[],w;const A=[];if(n===!0)c=Object.entries(s.columns).map(([C,I])=>({dbKey:I.name,tsKey:C,field:re(I,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{const C=Object.fromEntries(Object.entries(s.columns).map(([P,T])=>[P,re(T,o)]));if(n.where){const P=typeof n.where=="function"?n.where(C,go()):n.where;w=P&&Ge(P,o)}const I=[];let _=[];if(n.columns){let P=!1;for(const[T,j]of Object.entries(n.columns))j!==void 0&&T in s.columns&&(!P&&j===!0&&(P=!0),_.push(T));_.length>0&&(_=P?_.filter(T=>n.columns?.[T]===!0):Object.keys(s.columns).filter(T=>!_.includes(T)))}else _=Object.keys(s.columns);for(const P of _){const T=s.columns[P];I.push({tsKey:P,value:T})}let U=[];n.with&&(U=Object.entries(n.with).filter(P=>!!P[1]).map(([P,T])=>({tsKey:P,queryConfig:T,relation:s.relations[P]})));let k;if(n.extras){k=typeof n.extras=="function"?n.extras(C,{sql:a}):n.extras;for(const[P,T]of Object.entries(k))I.push({tsKey:P,value:mr(T,o)})}for(const{tsKey:P,value:T}of I)c.push({dbKey:f(T,v.Aliased)?T.fieldAlias:s.columns[P].name,tsKey:P,field:f(T,L)?re(T,o):T,relationTableTsKey:void 0,isJson:!1,selection:[]});let E=typeof n.orderBy=="function"?n.orderBy(C,yo()):n.orderBy??[];Array.isArray(E)||(E=[E]),g=E.map(P=>f(P,L)?re(P,o):Ge(P,o)),p=n.limit,h=n.offset;for(const{tsKey:P,queryConfig:T,relation:j}of U){const Z=So(t,r,j),J=r[Oe(j.referencedTable)],H=`${o}_${P}`,ue=K(...Z.fields.map((Qe,rt)=>fe(re(Z.references[rt],H),re(Qe,o)))),D=this._buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:r,table:e[J],tableConfig:t[J],queryConfig:f(j,Fe)?T===!0?{limit:1}:{...T,limit:1}:T,tableAlias:H,joinOn:ue,nestedQueryRelation:j}),ee=a`${a.identifier(H)}.${a.identifier("data")}`.as(P);A.push({on:a`true`,table:new V(D.sql,{},H),alias:H,joinType:"left",lateral:!0}),c.push({dbKey:P,tsKey:P,field:ee,relationTableTsKey:J,isJson:!0,selection:D.selection})}}if(c.length===0)throw new De({message:`No fields selected for table "${s.tsName}" ("${o}")`});let x;if(w=K(d,w),l){let C=a`json_build_array(${a.join(c.map(({field:_,tsKey:U,isJson:k})=>k?a`${a.identifier(`${o}_${U}`)}.${a.identifier("data")}`:f(_,v.Aliased)?_.sql:_),a`, `)})`;f(l,Wr)&&(C=a`coalesce(json_agg(${C}${g.length>0?a` order by ${a.join(g,a`, `)}`:void 0}), '[]'::json)`);const I=[{dbKey:"data",tsKey:"data",field:C.as("data"),isJson:!0,relationTableTsKey:s.tsName,selection:c}];p!==void 0||h!==void 0||g.length>0?(x=this.buildSelectQuery({table:ie(i,o),fields:{},fieldsFlat:[{path:[],field:a.raw("*")}],where:w,limit:p,offset:h,orderBy:g,setOperators:[]}),w=void 0,p=void 0,h=void 0,g=[]):x=ie(i,o),x=this.buildSelectQuery({table:f(x,R)?x:new V(x,{},o),fields:{},fieldsFlat:I.map(({field:_})=>({path:[],field:f(_,L)?re(_,o):_})),joins:A,where:w,limit:p,offset:h,orderBy:g,setOperators:[]})}else x=this.buildSelectQuery({table:ie(i,o),fields:{},fieldsFlat:c.map(({field:C})=>({path:[],field:f(C,L)?re(C,o):C})),joins:A,where:w,limit:p,offset:h,orderBy:g,setOperators:[]});return{tableTsKey:s.tsName,sql:x,selection:c}}nestedSelectionerror(){throw new De({message:"Views with nested selections are not supported by the relational query builder"})}buildRqbColumn(e,t,r){if(f(t,L)){const i=a`${e}.${a.identifier(this.casing.getColumnCasing(t))}`;let s=t.columnType,n=t,o=0;for(;f(n,cr);)n=n.baseColumn,s=n.columnType,++o;switch(s){case"PgNumeric":case"PgNumericNumber":case"PgNumericBigInt":case"PgBigInt64":case"PgBigIntString":case"PgBigSerial64":case"PgTimestampString":case"PgGeometry":case"PgGeometryObject":case"PgBytea":{const l="[]".repeat(o);return a`${i}::text${a.raw(l).if(l)} as ${a.identifier(r)}`}case"PgCustomColumn":return a`${n.jsonSelectIdentifier(i,a,o>0?o:void 0)} as ${a.identifier(r)}`;default:return a`${i} as ${a.identifier(r)}`}}return a`${e}.${f(t,v.Aliased)?a.identifier(t.fieldAlias):xt(t)?a.identifier(r):this.nestedSelectionerror()} as ${a.identifier(r)}`}unwrapAllColumns=(e,t)=>a.join(Object.entries(e[me]).map(([r,i])=>(t.push({key:r,field:i}),this.buildRqbColumn(e,i,r))),a`, `);buildColumns=(e,t,r)=>r?.columns?(()=>{const i=Object.entries(r.columns),s=e[me],n=[];let o;for(const[l,d]of i)if(d!==void 0&&(o=o||d,d)){const c=s[l];n.push(this.buildRqbColumn(e,c,l)),t.push({key:l,field:c})}if(o===!1)for(const[l,d]of Object.entries(s))r.columns[l]!==!1&&(n.push(this.buildRqbColumn(e,d,l)),t.push({key:l,field:d}));return n.length?a.join(n,a`, `):void 0})():this.unwrapAllColumns(e,t);buildRelationalQuery({schema:e,table:t,tableConfig:r,queryConfig:i,relationWhere:s,mode:n,errorPath:o,depth:l,throughJoin:d}){const c=[],p=n==="first",h=i===!0?void 0:i,g=o??"",w=l??0;w||(t=ie(t,`d${w}`));const A=p?1:h?.limit,x=h?.offset,C=h?.where&&s?K(de(t,h.where,r.relations,e,this.casing),s):h?.where?de(t,h.where,r.relations,e,this.casing):s,I=h?.orderBy?sn(t,h.orderBy):void 0,_=this.buildColumns(t,c,h),U=h?.extras?nn(t,h.extras):void 0;U&&c.push(...U.selection);const k=_?[_]:[],E=h?(()=>{const{with:P}=h;if(!P)return;const T=Object.entries(P).filter(([j,Z])=>Z);if(T.length)return a.join(T.map(([j,Z])=>{const J=r.relations[j],H=f(J,qr),ue=ie(J.targetTable,`d${w+1}`),D=J.throughTable?ie(J.throughTable,`tr${w}`):void 0,{filter:ee,joinCondition:Qe}=Qr(this.casing,J,t,ue,D);k.push(a`${a.identifier(j)}.${a.identifier("r")} as ${a.identifier(j)}`);const rt=D?a` inner join ${Ae(D)} on ${Qe}`:void 0,Lt=this.buildRelationalQuery({table:ue,mode:H?"first":"many",schema:e,queryConfig:Z,tableConfig:e[J.targetTableName],relationWhere:ee,errorPath:`${g.length?`${g}.`:""}${j}`,depth:w+1,throughJoin:rt});return c.push({field:ue,key:j,selection:Lt.selection,isArray:!H,isOptional:(J.optional??!1)||Z!==!0&&!!Z.where}),a`left join lateral(select ${H?a`row_to_json(${a.identifier("t")}.*) ${a.identifier("r")}`:a`coalesce(json_agg(row_to_json(${a.identifier("t")}.*)), '[]') as ${a.identifier("r")}`} from (${Lt.sql}) as ${a.identifier("t")}) as ${a.identifier(j)} on true`}),a` `)})():void 0;if(U?.sql&&k.push(U.sql),!k.length)throw new De({message:`No fields selected for table "${r.name}"${g?` ("${g}")`:""}`});return{sql:a`select ${a.join(k.filter(P=>P!==void 0),a`, `)} from ${Ae(t)}${d}${a` ${E}`.if(E)}${a` where ${C}`.if(C)}${a` order by ${I}`.if(I)}${a` limit ${A}`.if(A!==void 0)}${a` offset ${x}`.if(x!==void 0)}`,selection:c}}},No=class{static[u]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}},Y=class{static[u]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){const t=!!this.fields,r=e;let i;return this.fields?i=this.fields:f(r,V)?i=Object.fromEntries(Object.keys(r._.selectedFields).map(s=>[s,r[s]])):f(r,Yr)?i=r[B].selectedFields:f(r,v)?i={}:i=ln(r),new Xr({table:r,fields:i,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},_o=class extends No{static[u]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:e,fields:t,isPartialSelect:r,session:i,dialect:s,withList:n,distinct:o}){super(),this.config={withList:n,table:e,fields:{...t},distinct:o,setOperators:[]},this.isPartialSelect=r,this.session=i,this.dialect=s,this._={selectedFields:t,config:this.config},this.tableName=we(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{};for(const l of Pe(e))this.usedTables.add(l)}getUsedTables(){return[...this.usedTables]}createJoin(e,t){return((r,i)=>{const s=this.tableName,n=we(r);for(const o of Pe(r))this.usedTables.add(o);if(typeof n=="string"&&this.config.joins?.some(o=>o.alias===n))throw new Error(`Alias "${n}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof s=="string"&&(this.config.fields={[s]:this.config.fields}),typeof n=="string"&&!f(r,v))){const o=f(r,V)?r._.selectedFields:f(r,ye)?r[B].selectedFields:r[b.Symbol.Columns];this.config.fields[n]=o}if(typeof i=="function"&&(i=i(new Proxy(this.config.fields,new M({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:i,table:r,joinType:e,alias:n,lateral:t}),typeof n=="string")switch(e){case"left":this.joinsNotNullableMap[n]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[n]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[n]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[n]=!1;break}return this})}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);fullJoin=this.createJoin("full",!1);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(e,t){return r=>{const i=typeof r=="function"?r(Ao()):r;if(!At(this.getSelectedFields(),i.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:i}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new M({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new M({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){const t=e[0](new Proxy(this.config.fields,new M({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){const t=e[0](new Proxy(this.config.fields,new M({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else{const t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){const t=[];if(t.push(...Pe(this.config.table)),this.config.joins)for(const r of this.config.joins)t.push(...Pe(r.table));return new Proxy(new V(this.getSQL(),this.config.fields,e,!1,[...new Set(t)]),new M({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new M({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(e){return this.cacheConfig=e===void 0?{config:{},enable:!0,autoInvalidate:!0}:e===!1?{enable:!1}:{enable:!0,autoInvalidate:!0,...e},this}},Xr=class extends _o{static[u]="PgSelect";_prepare(e){const{session:t,config:r,dialect:i,joinsNotNullableMap:s,authToken:n,cacheConfig:o,usedTables:l}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");const{fields:d}=r;return q.startActiveSpan("drizzle.prepareQuery",()=>{const c=$e(d),p=t.prepareQuery(i.sqlToQuery(this.getSQL()),c,e,!0,void 0,{type:"select",tables:[...l]},o);return p.joinsNotNullableMap=s,p.setToken(n)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>q.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};on(Xr,[be]);function Be(e,t){return(r,i,...s)=>{const n=[i,...s].map(o=>({type:e,isAll:t,rightSelect:o}));for(const o of n)if(!At(r.getSelectedFields(),o.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(n)}}var Ao=()=>({union:Lo,unionAll:qo,intersect:Bo,intersectAll:Qo,except:ko,exceptAll:Io}),Lo=Be("union",!1),qo=Be("union",!0),Bo=Be("intersect",!1),Qo=Be("intersect",!0),ko=Be("except",!1),Io=Be("except",!0),Zr=class{static[u]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=f(e,We)?e:void 0,this.dialectConfig=f(e,We)?void 0:e}$with=(e,t)=>{const r=this;return{as:s=>(typeof s=="function"&&(s=s(r)),new Proxy(new hr(s.getSQL(),t??("getSelectedFields"in s?s.getSelectedFields()??{}:{}),e,!0),new M({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){const t=this;function r(n){return new Y({fields:n??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function i(n){return new Y({fields:n??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function s(n,o){return new Y({fields:o??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:n}})}return{select:r,selectDistinct:i,selectDistinctOn:s}}select(e){return new Y({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Y({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new Y({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new We(this.dialectConfig)),this.dialect}},Ft=class{constructor(e,t,r,i,s){this.table=e,this.session=t,this.dialect=r,this.withList=i,this.overridingSystemValue_=s}static[u]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");const t=e.map(r=>{const i={},s=this.table[b.Symbol.Columns];for(const n of Object.keys(r)){const o=r[n];i[n]=f(o,v)?o:new pe(o,s[n])}return i});return new Vt(this.table,t,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){const t=typeof e=="function"?e(new Zr):e;if(!f(t,v)&&!At(this.table[me],t._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new Vt(this.table,t,this.session,this.dialect,this.withList,!0)}},Vt=class extends be{constructor(e,t,r,i,s,n,o){super(),this.session=r,this.dialect=i,this.config={table:e,values:t,withList:s,select:n,overridingSystemValue_:o}}static[u]="PgInsert";config;cacheConfig;returning(e=this.config.table[b.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=$e(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=a`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));const r=e.where?a` where ${e.where}`:void 0;this.config.onConflict=a`(${a.raw(t)})${r} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');const t=e.where?a` where ${e.where}`:void 0,r=e.targetWhere?a` where ${e.targetWhere}`:void 0,i=e.setWhere?a` where ${e.setWhere}`:void 0,s=this.dialect.buildUpdateSet(this.config.table,kr(this.config.table,e.set));let n="";return n=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=a`(${a.raw(n)})${r} do update set ${s}${t}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return q.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"insert",tables:Pe(this.config.table)},this.cacheConfig))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>q.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new M({alias:ne(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}},jo=class extends be{constructor(e,t,r){super(),this.session=t,this.dialect=r,this.config={view:e}}static[u]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return q.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>q.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))},Et=class{constructor(e,t,r,i){this.table=e,this.session=t,this.dialect=r,this.withList=i}static[u]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Do(this.table,kr(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Do=class extends be{constructor(e,t,r,i,s){super(),this.session=r,this.dialect=i,this.config={set:t,table:e,withList:s,joins:[]},this.tableName=we(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[u]="PgUpdate";config;tableName;joinsNotNullableMap;cacheConfig;from(e){const t=e,r=we(t);return typeof r=="string"&&(this.joinsNotNullableMap[r]=!0),this.config.from=t,this}getTableLikeFields(e){return f(e,R)?e[b.Symbol.Columns]:f(e,V)?e._.selectedFields:e[B].selectedFields}createJoin(e){return((t,r)=>{const i=we(t);if(typeof i=="string"&&this.config.joins.some(s=>s.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(typeof r=="function"){const s=this.config.from&&!f(this.config.from,v)?this.getTableLikeFields(this.config.from):void 0;r=r(new Proxy(this.config.table[b.Symbol.Columns],new M({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),s&&new Proxy(s,new M({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:r,table:t,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":this.joinsNotNullableMap[i]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[i]=!0;break;case"inner":this.joinsNotNullableMap[i]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[i]=!1;break}return this})}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[b.Symbol.Columns]),this.config.from)){const t=we(this.config.from);if(typeof t=="string"&&this.config.from&&!f(this.config.from,v)){const r=this.getTableLikeFields(this.config.from);e[t]=r}for(const r of this.config.joins){const i=we(r.table);if(typeof i=="string"&&!f(r.table,v)){const s=this.getTableLikeFields(r.table);e[i]=s}}}return this.config.returningFields=e,this.config.returning=$e(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){const t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"insert",tables:Pe(this.config.table)},this.cacheConfig);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new M({alias:ne(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}},zo=class{constructor(e,t,r,i,s,n,o){this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=s,this.dialect=n,this.session=o}static[u]="PgRelationalQueryBuilder";findMany(e){return new Rt(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Rt(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},Rt=class extends be{constructor(e,t,r,i,s,n,o,l,d){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=s,this.dialect=n,this.session=o,this.config=l,this.mode=d}static[u]="PgRelationalQuery";_prepare(e){return q.startActiveSpan("drizzle.prepareQuery",()=>{const{query:t,builtQuery:r}=this._toSQL();return this.session.prepareQuery(r,void 0,e,!0,(i,s)=>{const n=i.map(o=>pt(this.schema,this.tableConfig,o,t.selection,s));return this.mode==="first"?n[0]:n})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect._buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){const e=this._getQuery();return{query:e,builtQuery:this.dialect.sqlToQuery(e.sql)}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return q.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}},Oo=class gt extends v{constructor(t){super(gt.buildEmbeddedCount(t.source,t.filters).queryChunks),this.params=t,this.mapWith(Number),this.session=t.session,this.sql=gt.buildCount(t.source,t.filters)}sql;token;static[u]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(t,r){return a`(select count(*) from ${t}${a.raw(" where ").if(r)}${r})`}static buildCount(t,r){return a`select count(*) as count from ${t}${a.raw(" where ").if(r)}${r};`}setToken(t){return this.token=t,this}then(t,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(t,r)}catch(t){return this.then(void 0,t)}finally(t){return this.then(r=>(t?.(),r),r=>{throw t?.(),r})}},Fo=class{constructor(e,t,r,i,s,n){this.schema=e,this.table=t,this.tableConfig=r,this.dialect=i,this.session=s,this.parseJson=n}static[u]="PgRelationalQueryBuilderV2";findMany(e){return new Mt(this.schema,this.table,this.tableConfig,this.dialect,this.session,e??!0,"many",this.parseJson)}findFirst(e){return new Mt(this.schema,this.table,this.tableConfig,this.dialect,this.session,e??!0,"first",this.parseJson)}},Mt=class extends be{constructor(e,t,r,i,s,n,o,l){super(),this.schema=e,this.table=t,this.tableConfig=r,this.dialect=i,this.session=s,this.config=n,this.mode=o,this.parseJson=l}static[u]="PgRelationalQueryV2";_prepare(e){return q.startActiveSpan("drizzle.prepareQuery",()=>{const{query:t,builtQuery:r}=this._toSQL();return this.session.prepareRelationalQuery(r,void 0,e,(i,s)=>{const n=i.map(o=>ht(o,t.selection,s,this.parseJson));return this.mode==="first"?n[0]:n})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQuery({schema:this.schema,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,mode:this.mode})}getSQL(){return this._getQuery().sql}_toSQL(){const e=this._getQuery();return{query:e,builtQuery:this.dialect.sqlToQuery(e.sql)}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return q.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}},Vo=class extends be{constructor(e,t,r,i){super(),this.execute=e,this.sql=t,this.query=r,this.mapBatchResult=i}static[u]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}},ei=class{constructor(e,t,r,i,s=!1){if(this.dialect=e,this.session=t,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,relations:r,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},relations:r,session:t},this._query={},this._.schema)for(const[n,o]of Object.entries(this._.schema))this._query[n]=new zo(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[n],o,e,t);this.query={};for(const[n,o]of Object.entries(r))this.query[n]=new Fo(r,r[o.name].table,o,e,t,s);this.$cache={invalidate:async n=>{}}}static[u]="PgDatabase";_query;query;$with=(e,t)=>{const r=this;return{as:s=>(typeof s=="function"&&(s=s(new Zr(r.dialect))),new Proxy(new hr(s.getSQL(),t??("getSelectedFields"in s?s.getSelectedFields()??{}:{}),e,!0),new M({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new Oo({source:e,filters:t,session:this.session})}$cache;with(...e){const t=this;function r(d){return new Y({fields:d??void 0,session:t.session,dialect:t.dialect,withList:e})}function i(d){return new Y({fields:d??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})}function s(d,c){return new Y({fields:c??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:d}})}function n(d){return new Et(d,t.session,t.dialect,e)}function o(d){return new Ft(d,t.session,t.dialect,e)}function l(d){return new Ot(d,t.session,t.dialect,e)}return{select:r,selectDistinct:i,selectDistinctOn:s,update:n,insert:o,delete:l}}select(e){return new Y({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new Y({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new Y({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Et(e,this.session,this.dialect)}insert(e){return new Ft(e,this.session,this.dialect)}delete(e){return new Ot(e,this.session,this.dialect)}refreshMaterializedView(e){return new jo(e,this.session,this.dialect)}authToken;execute(e){const t=typeof e=="string"?a.raw(e):e.getSQL(),r=this.dialect.sqlToQuery(t),i=this.session.prepareQuery(r,void 0,void 0,!1);return new Vo(()=>i.execute(void 0,this.authToken),t,r,s=>i.mapResult(s,!0))}transaction(e,t){return this.session.transaction(e,t)}},Eo=class{static[u]="Cache"},ti=class extends Eo{strategy(){return"all"}static[u]="NoopCache";async get(e){}async put(e,t,r,i){}async onMutate(e){}};async function Ut(e,t){const r=`${e}-${JSON.stringify(t)}`,i=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",i);return[...new Uint8Array(s)].map(n=>n.toString(16).padStart(2,"0")).join("")}var Ro=class{constructor(e,t,r,i){this.query=e,this.cache=t,this.queryMetadata=r,this.cacheConfig=i,t&&t.strategy()==="all"&&i===void 0&&(this.cacheConfig={enable:!0,autoInvalidate:!0}),this.cacheConfig?.enable||(this.cacheConfig=void 0)}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static[u]="PgPreparedQuery";joinsNotNullableMap;async queryWithCache(e,t,r){if(this.cache===void 0||f(this.cache,ti)||this.queryMetadata===void 0)try{return await r()}catch(i){throw new Te(e,t,i)}if(this.cacheConfig&&!this.cacheConfig.enable)try{return await r()}catch(i){throw new Te(e,t,i)}if((this.queryMetadata.type==="insert"||this.queryMetadata.type==="update"||this.queryMetadata.type==="delete")&&this.queryMetadata.tables.length>0)try{const[i]=await Promise.all([r(),this.cache.onMutate({tables:this.queryMetadata.tables})]);return i}catch(i){throw new Te(e,t,i)}if(!this.cacheConfig)try{return await r()}catch(i){throw new Te(e,t,i)}if(this.queryMetadata.type==="select"){const i=await this.cache.get(this.cacheConfig.tag??await Ut(e,t),this.queryMetadata.tables,this.cacheConfig.tag!==void 0,this.cacheConfig.autoInvalidate);if(i===void 0){let s;try{s=await r()}catch(n){throw new Te(e,t,n)}return await this.cache.put(this.cacheConfig.tag??await Ut(e,t),s,this.cacheConfig.autoInvalidate?this.queryMetadata.tables:[],this.cacheConfig.tag!==void 0,this.cacheConfig.config),s}return i}try{return await r()}catch(i){throw new Te(e,t,i)}}},Mo=class{constructor(e){this.dialect=e}static[u]="PgSession";execute(e,t){return q.startActiveSpan("drizzle.operation",()=>q.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){const r=await this.execute(e,t);return Number(r[0].count)}},Uo=class extends ei{constructor(e,t,r,i,s=0,n){super(e,t,r,i,n),this.relations=r,this.schema=i,this.nestedIndex=s}static[u]="PgTransaction";rollback(){throw new Us}getTransactionConfigSQL(e){const t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),typeof e.deferrable=="boolean"&&t.push(e.deferrable?"deferrable":"not deferrable"),a.raw(t.join(" "))}setTransaction(e){return this.session.execute(a`set transaction ${this.getTransactionConfigSQL(e)}`)}},Jt=class extends Ro{constructor(e,t,r,i,s,n,o,l,d,c,p){super({sql:t,params:r},s,n,o),this.client=e,this.queryString=t,this.params=r,this.logger=i,this.fields=l,this._isResponseInArrayMode=d,this.customResultMapper=c,this.isRqbV2Query=p}static[u]="PostgresJsPreparedQuery";async execute(e={}){return this.isRqbV2Query?this.executeRqbV2(e):q.startActiveSpan("drizzle.execute",async t=>{const r=at(this.params,e);t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r);const{fields:i,queryString:s,client:n,joinsNotNullableMap:o,customResultMapper:l}=this;if(!i&&!l)return q.startActiveSpan("drizzle.driver.execute",()=>this.queryWithCache(s,r,async()=>await n.unsafe(s,r)));const d=await q.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":s,"drizzle.query.params":JSON.stringify(r)}),this.queryWithCache(s,r,async()=>await n.unsafe(s,r).values())));return q.startActiveSpan("drizzle.mapResponse",()=>l?l(d):d.map(c=>an(i,c,o)))})}async executeRqbV2(e={}){return q.startActiveSpan("drizzle.execute",async t=>{const r=at(this.params,e);t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r);const{queryString:i,client:s,customResultMapper:n}=this,o=await q.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":i,"drizzle.query.params":JSON.stringify(r)}),s.unsafe(i,r)));return q.startActiveSpan("drizzle.mapResponse",()=>n(o))})}all(e={}){return q.startActiveSpan("drizzle.execute",async t=>{const r=at(this.params,e);return t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r),q.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.queryWithCache(this.queryString,r,async()=>this.client.unsafe(this.queryString,r))))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},ri=class ii extends Mo{constructor(t,r,i,s,n={}){super(r),this.client=t,this.relations=i,this.schema=s,this.options=n,this.logger=n.logger??new Ws,this.cache=n.cache??new ti}static[u]="PostgresJsSession";logger;cache;prepareQuery(t,r,i,s,n,o,l){return new Jt(this.client,t.sql,t.params,this.logger,this.cache,o,l,r,s,n)}prepareRelationalQuery(t,r,i,s){return new Jt(this.client,t.sql,t.params,this.logger,this.cache,void 0,void 0,r,!1,s,!0)}query(t,r){return this.logger.logQuery(t,r),this.client.unsafe(t,r).values()}queryObjects(t,r){return this.client.unsafe(t,r)}transaction(t,r){return this.client.begin(async i=>{const s=new ii(i,this.dialect,this.relations,this.schema,this.options),n=new Jo(this.dialect,s,this.schema,this.relations);return r&&await n.setTransaction(r),t(n)})}},Jo=class si extends Uo{constructor(t,r,i,s,n=0){super(t,r,s,i,n),this.session=r}static[u]="PostgresJsTransaction";transaction(t){return this.session.client.savepoint(r=>{const i=new ri(r,this.dialect,this.relations,this.schema,this.session.options);return t(new si(this.dialect,i,this.schema,this.relations))})}},Ko=class extends ei{static[u]="PostgresJsDatabase"};function Ie(e,t={}){const r=d=>d;for(const d of["1184","1082","1083","1114","1182","1185","1115","1231"])e.options.parsers[d]=r,e.options.serializers[d]=r;e.options.serializers[114]=r,e.options.serializers[3802]=r;const i=new We({casing:t.casing});let s;t.logger===!0?s=new Ks:t.logger!==!1&&(s=t.logger);let n;if(t.schema){const d=bo(t.schema,Po);n={fullSchema:t.schema,schema:d.tables,tableNamesMap:d.tableNamesMap}}const o=t.relations??{},l=new Ko(i,new ri(e,i,o,n,{logger:s,cache:t.cache}),o,n);return l.$client=e,l.$cache=t.cache,l.$cache&&(l.$cache.invalidate=t.cache?.onMutate),l}function yt(...e){if(typeof e[0]=="string")return Ie(Je(e[0]),e[1]);const{connection:t,client:r,...i}=e[0];if(r)return Ie(r,i);if(typeof t=="object"&&t.url!==void 0){const{url:s,...n}=t;return Ie(Je(s,n),i)}return Ie(Je(t),i)}(e=>{function t(r){return Ie({options:{parsers:{},serializers:{}}},r)}e.mock=t})(yt||(yt={}));var Wo=process.env.DATABASE_URL??`postgresql://${process.env.POSTGRES_USER??"prometheus"}:${process.env.POSTGRES_PASSWORD??"secret"}@${process.env.POSTGRES_HOST??"localhost"}:${process.env.POSTGRES_PORT??5433}/${process.env.POSTGRES_DB??"prometheus"}`,Ho=process.env.POSTGRES_SSL==="true"?"require":!1;const Go=Je(Wo,{max:5,ssl:Ho}),tt=yt({client:Go}),oe=Yt("store_items",{id:Xt("id").primaryKey(),name:lt("name").notNull(),price:Ti("price",{precision:10,scale:2}).notNull(),createdAt:Zt("created_at",{mode:"date",withTimezone:!1}).defaultNow()}),ru=Yt("chat_messages",{id:Xt("id").primaryKey(),author:lt("author").notNull(),body:lt("body").notNull(),createdAt:Zt("created_at",{mode:"date",withTimezone:!1}).defaultNow()});var ni=e=>{const t=Number.parseFloat(String(e.price));return{id:e.id,name:e.name,price:Number.isFinite(t)?t:0}};const Yo=({cacheControl:e})=>{e({public:!0,maxAge:300,sMaxAge:900,staleWhileRevalidate:60})};var ai=async e=>{const r=Number.isFinite(e)&&(e??0)>0?Number(e):0,i=tt.select().from(oe),s=r>0?i.where(et(oe.id,r)):i;try{const n=(await s.orderBy(oe.id).limit(6)).map(ni);return{items:n,cursor:n.length===6?n[n.length-1].id:null,source:"db"}}catch(n){return console.error("Failed to load store items",n),{items:[{id:-1,name:y`Sample adapter (offline)`,price:24.99},{id:-2,name:y`Edge cache pack (offline)`,price:12.5}],cursor:null,source:"fallback"}}},Xo=xi(async e=>ai(e),"o0FSe7O5kbg");const Zo=bi(N(Xo,"s_o0FSe7O5kbg"));var el=async()=>ai();const oi=mi(N(el,"s_v669J74jz24"));var tl=async e=>{const t=Number.parseInt(String(e.id??""),10);if(!Number.isFinite(t)||t<=0)return{success:!1,error:y`Invalid id.`};try{const[r]=await tt.delete(oe).where(fe(oe.id,t)).returning();return r?{success:!0,id:t}:{success:!1,error:y`Item not found.`}}catch(r){return console.error("Failed to delete store item",r),{success:!1,error:y`Unable to delete item right now.`}}};const li=Ht(N(tl,"s_R9VLNISWb6o"));var rl=async e=>{const t=String(e.name??"").trim(),r=Number.parseFloat(String(e.price??""));if(!t||Number.isNaN(r)||r<=0)return{success:!1,error:y`Name and positive price required.`};try{const[i]=await tt.insert(oe).values({name:t,price:r.toString()}).returning();return{success:!0,item:ni(i)}}catch(i){return console.error("Failed to create store item",i),{success:!1,error:y`Unable to create item right now.`}}};const ui=Ht(N(rl,"s_nexPpNJs6FU"));var il=[.16,1,.3,1],sl=[.4,0,1,1],ci=()=>typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion: reduce)").matches,di=e=>`cubic-bezier(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`,nl=()=>new Promise(e=>{if(typeof requestAnimationFrame!="function"){e();return}requestAnimationFrame(()=>requestAnimationFrame(()=>e()))}),hi=e=>e.finished?.then(()=>{})??new Promise((t,r)=>{e.addEventListener("finish",()=>t(),{once:!0}),e.addEventListener("cancel",()=>r(new Error("Animation cancelled")),{once:!0})}),al=async(e,t,r)=>{if(!e.length||typeof document>"u"||typeof e[0]?.animate!="function")return;const i=e.map((s,n)=>{const o=typeof r.delay=="function"?r.delay(n):r.delay;return s.animate(t,{...r,delay:o})});await Promise.all(i.map(s=>hi(s)))},ol=async(e,t="new")=>{if(typeof document>"u"||!e.length||ci())return;await nl();const r=e.map(i=>document.querySelector(`[data-store-item-id="${i}"]`)).filter(i=>!!i);if(r.length)try{const i=t==="initial"?.7:0,s=t==="initial"?12:8,n=t==="initial"?.99:.98,o=t==="initial"?500:380,l=t==="initial"?60:45;await al(r,[{opacity:i,transform:`translate3d(0, ${s}px, 0) scale(${n})`},{opacity:1,transform:"translate3d(0, 0, 0) scale(1)"}],{duration:o,easing:di(il),fill:"none",delay:d=>d*l})}catch(i){console.error("Failed to run entrance animations",i)}},ll=async e=>{const[t]=le(),r=()=>{const s=()=>{t.value=t.value.filter(o=>o.id!==e)};if(typeof document>"u"){s();return}const n=document.startViewTransition;if(typeof n=="function"){n.call(document,s);return}s()};if(typeof document>"u"||ci())return r();const i=document.querySelector(`[data-store-item-id="${e}"]`);if(!i){r();return}try{await hi(i.animate([{opacity:1,transform:"translate3d(0, 0, 0) scale(1)"},{opacity:0,transform:"translate3d(0, -8px, 0) scale(0.96)"}],{duration:220,easing:di(sl),fill:"both"}))}catch(s){console.error("Failed to animate removal",s)}r()},ul=async(e=!1)=>{const[t,r,i,s,n,o]=le();if(!o.value){o.value=!0,i.value=null;try{const l=await Zo(e?void 0:r.value??void 0),d=l?.items??[],c=e?d:[...n.value,...d],p=e?new Set:new Set(n.value.map(w=>w.id)),h=d.map(w=>w.id).filter(w=>!p.has(w)),g=()=>{n.value=c};if(typeof document>"u")g();else{const w=document.startViewTransition;typeof w=="function"?w.call(document,g):g()}r.value=l?.cursor??null,s.value=l?.source==="fallback",i.value=l?.source==="fallback"?y`Database offline: showing fallback inventory.`:null,t(h)}catch(l){console.error("Failed to load store items",l),i.value=y`Unable to load inventory right now.`}finally{o.value=!1}}},cl=async(e,t)=>{const[r]=le();await r(t.dataset.reset==="1")},dl=({track:e})=>{const[t,r,i,s]=le(),n=e(()=>r.value);if(n?.success&&n.item){const o=[...s.value.filter(d=>d.id!==n.item.id),n.item];o.sort((d,c)=>d.id-c.id);const l=()=>{s.value=o};if(typeof document>"u")l();else{const d=document.startViewTransition;typeof d=="function"?d.call(document,l):l()}i.value=null,t([n.item.id])}},hl=({track:e})=>{const[t,r,i]=le(),s=e(()=>r.value);s?.success&&s.id?(t(s.id),i.value=null):s?.error&&(i.value=s.error)},fl=()=>{const e=oi(),t=X(e.value.items),r=X(e.value.cursor),i=X(!1),s=X(e.value.source==="fallback"),n=X(e.value.source==="fallback"?y`Database offline: showing fallback inventory.`:null),o=ui(),l=li(),d=N(ol,"s_ZF5ox75ncAY"),c=N(ll,"s_i5YbwZ5sHVc",[t]),p=N(cl,"s_dQlMqeLWpD0",[N(ul,"s_69ywUjDxRgU",[d,r,n,s,t,i])]);return ot(N(dl,"s_h70dBAjCmqY",[d,o,n,t]),{eagerness:"idle"}),ot(N(hl,"s_fap9umrX08E",[c,l,n]),{eagerness:"idle"}),m("div",null,{class:"gap-4 grid md:grid-cols-[1.2fr_1fr] bg-slate-900/60 mt-5 p-4 border border-slate-800 rounded-lg"},[m("div",null,{class:"space-y-4"},[m("div",null,{class:"flex justify-between items-center"},[m("p",null,{class:"text-slate-300 text-sm"},y`Inventory`,1,null),m("button",null,{type:"button",class:"bg-slate-800 hover:bg-slate-700 disabled:opacity-60 px-3 py-2 rounded-lg ring-1 ring-slate-700 font-semibold text-slate-100 text-xs transition","data-reset":"1",disabled:se(h=>h.value,[i],"p0.value"),onClick$:p},y`Refresh`,1,null)],1,null),s.value&&m("p",null,{class:"text-amber-300 text-xs"},y`Showing fallback data while the database is unavailable.`,1,"YL_0"),n.value&&m("p",null,{class:"text-rose-300 text-sm"},se(h=>h.value,[n],"p0.value"),3,"YL_1"),t.value.length?m("ul",null,{class:"gap-3 grid md:grid-cols-2",style:{viewTransitionName:"store-grid"}},t.value.map(h=>m("li",{"data-store-item-id":te(h,"id"),style:{viewTransitionName:`store-item-${h.id}`}},{class:"surface space-y-2 p-4"},[m("div",null,{class:"flex justify-between items-start gap-3"},[m("div",null,null,[m("p",null,{class:"text-slate-400 text-sm"},y`SKU ${h.id}`,1,null),m("p",null,{class:"font-semibold text-slate-50 text-lg"},te(h,"name"),1,null)],1,null),z(qt,{action:l,class:"shrink-0",children:[m("input",{value:te(h,"id")},{type:"hidden",name:"id"},null,3,null),m("button",{disabled:l.isRunning||h.id<=0,"aria-label":y`Delete ${h.name}`},{type:"submit",class:"hover:bg-rose-500/10 disabled:opacity-60 px-2 py-1 rounded-md ring-1 ring-slate-700 hover:ring-rose-500 text-slate-400 hover:text-rose-200 text-xs transition"},y`Delete`,1,null)],[ce]:{action:ce,class:ce}},1,"YL_2")],1,null),m("p",null,{class:"text-emerald-300"},["$",h.price.toFixed(2)],1,null)],1,h.id)),1,"YL_3"):!i.value&&m("p",null,{class:"text-slate-500 text-sm"},y`No items yet.`,1,"YL_4"),m("div",null,{class:"flex items-center gap-3"},[r.value!==null&&m("button",null,{type:"button",class:"bg-emerald-500 hover:bg-emerald-400 disabled:opacity-60 px-4 py-2 rounded-lg font-semibold text-emerald-950 text-sm transition",disabled:se(h=>h.value,[i],"p0.value"),onClick$:p},y`Load more`,1,"YL_5"),i.value&&m("span",null,{class:"text-slate-400 text-xs"},y`Loading...`,1,"YL_6")],1,null)],1,null),m("div",null,{class:"space-y-3 bg-slate-900/80 p-4 border border-slate-800 rounded-lg"},[m("p",null,{class:"font-semibold text-slate-100 text-sm"},y`Add an item`,1,null),z(qt,{action:o,class:"space-y-3 text-slate-200 text-sm",children:[m("div",null,{class:"space-y-1"},[m("label",null,{class:"text-slate-400 text-xs uppercase tracking-wide",for:"name"},y`Name`,1,null),m("input",null,{id:"name",name:"name",class:"bg-slate-950 px-3 py-2 border border-slate-800 rounded-lg w-full text-slate-100",placeholder:y`Lightweight widget`,required:!0},null,3,null)],1,null),m("div",null,{class:"space-y-1"},[m("label",null,{class:"text-slate-400 text-xs uppercase tracking-wide",for:"price"},y`Price`,1,null),m("input",null,{id:"price",name:"price",type:"number",step:"0.01",min:"0",class:"bg-slate-950 px-3 py-2 border border-slate-800 rounded-lg w-full text-slate-100",placeholder:"24.99",required:!0},null,3,null)],1,null),m("button",null,{type:"submit",class:"bg-emerald-500 hover:bg-emerald-400 disabled:opacity-70 px-4 py-2 rounded-lg w-full font-semibold text-emerald-950 text-sm transition",disabled:se(h=>h.isRunning,[o],"p0.isRunning")},o.isRunning?y`Saving...`:y`Create item`,1,null),o.value?.error&&m("p",null,{class:"text-rose-300 text-xs"},se(h=>h.value.error,[o],"p0.value.error"),3,"YL_7"),o.value?.success&&o.value.item&&m("p",null,{class:"text-emerald-300 text-xs"},y`Added ${o.value.item.name}.`,1,"YL_8")],[ce]:{action:ce,class:ce}},1,"YL_9")],1,null)],1,"YL_10")};const ml=W(N(fl,"s_2aWAOZ0c5GI"));var pl="[data-store-item-id]{transform-origin:top;will-change:transform,opacity}@media (prefers-reduced-motion:reduce){[data-store-item-id]{transition:none!important;animation:none!important}}",gl=ge({default:()=>bl,head:()=>vl,onGet:()=>Yo,useCreateStoreItem:()=>ui,useDeleteStoreItem:()=>li,useStoreItemsLoader:()=>oi},1),yl=()=>(Ve(N(pl,"s_cOQoV5jD0Q4")),m("section",null,{class:"p-6 surface"},[m("div",null,{class:"flex justify-between items-center gap-2"},[m("div",null,null,[m("p",null,{class:"text-emerald-300 text-sm uppercase tracking-wide"},y`Store`,1,null),m("h1",null,{class:"font-semibold text-slate-50 text-2xl"},y`Fast browsing with tiny payloads`,1,null)],1,null),m("span",null,{class:"bg-slate-800 px-3 py-1 rounded-full text-slate-200 text-xs"},y`cached`,1,null)],1,null),m("p",null,{class:"mt-3 max-w-2xl text-slate-300 text-sm"},y`Items stream directly from Postgres via Drizzle, with cursor pagination to keep responses lean. Interactivity wakes up only when you click.`,1,null),z(ml,null,3,"3h_0")],1,"3h_1")),bl=W(N(yl,"s_bZ8kc5UlLx4"));const vl=({withLocale:e})=>e(()=>({title:y`Store | Prometheus`,meta:[{name:"description",content:y`Drizzle-powered store pulling from Postgres with cursor pagination and lazy loading.`}]}));var wl=ge({onGet:()=>Sl},1);const Sl=async({cacheControl:e,query:t,json:r})=>{e({public:!0,maxAge:300,sMaxAge:900,staleWhileRevalidate:60});const i=Number.parseInt(t.get("limit")??"",10),s=Number.parseInt(t.get("cursor")??"",10),n=Number.isFinite(i)&&i>0?Math.min(i,50):10,o=Number.isFinite(s)&&s>0?s:0;try{const l=tt.select().from(oe),d=(await(o>0?l.where(et(oe.id,o)):l).orderBy(oe.id).limit(n)).map(c=>({...c,price:Number.parseFloat(String(c.price))}));r(200,{items:d,cursor:d.length===n?d[d.length-1].id:null})}catch(l){console.error("Failed to load store items",l),r(500,{error:"Unable to load items right now."})}},Pl=[Ei];var Ce=()=>ns;const xl=[["/",[Ce,()=>hs],"/",["q-Dxr9WhSV.js","q-5XKFIS4r.js"]],["ai",[Ce,()=>ys],"/ai",["q-Dxr9WhSV.js","q-C4nvIbvE.js"]],["chat",[Ce,()=>Cs],"/chat",["q-Dxr9WhSV.js","q-XWCE1vqC.js"]],["index",[Ce,()=>cs],"/index",["q-Dxr9WhSV.js","q-DJj1k5i_.js"]],["store",[Ce,()=>gl],"/store",["q-Dxr9WhSV.js","q-B87jFo8T.js"]],["api/store/items",[Ce,()=>wl],"/api/store/items",["q-Dxr9WhSV.js"]]],$l=[];var Tl={routes:xl,serverPlugins:Pl,menus:$l,trailingSlash:!1,basePathname:"/",cacheModules:!0},Cl=({serverData:e})=>`/build${`/${e.locale}`}`,Nl=()=>{Ni(()=>Pi(Ye))},_l=()=>{const e=bt();return fi(Le("s_TVD7erg9zpo",[X(e.url.href),e])),z(Gt,null,3,"Dv_0")};const Al=W(N(_l,"s_w6dmeDadJmA"));var Ll={};globalThis.__EXPERIMENTAL__=Ll;var ql=()=>z(yi,{children:[m("head",null,null,[m("meta",null,{charSet:"utf-8"},null,3,null),z(sr,null,3,"xd_0")],1,null),m("body",null,{class:"app-shell"},z(Al,{children:z(vi,null,3,"xd_1")},1,"xd_2"),1,null)]},1,"xd_3"),Bl=W(N(ql,"s_8txvw3enrrU"));Nl();var Ql=e=>{const t=typeof e.base=="function"?e.base(e):e.base;return t?t.endsWith("/")?t:`${t}/`:"/build/"},Kt=e=>!!e&&typeof e=="object"&&"manifest"in e,kl=e=>{const t=e.serverData?.locale;if(t)return t;let r=null;const i=e.serverData?.url;if(i)try{r=new URL(i).searchParams.get("locale")}catch{r=null}const s=e.serverData?.requestHeaders?.["accept-language"]??void 0;return wt({queryLocale:r,acceptLanguage:s})};function Il(e){const t=e.manifest??Wt,r=Kt(t)?t.manifest:t,i=kl(e),s={...e.serverData,locale:i},n=Ql({...e,base:Cl,serverData:s}),o=`${n}${r?.qwikLoader??"qwikloader.js"}`,l={...e.containerAttributes,lang:i,"q:locale":i},c={tag:"script",location:"head",attributes:{"data-qwik-lazy-loader":"1",dangerouslySetInnerHTML:`(function(){const src='${o}';if(!src)return;let started=false;const load=()=>{if(started||navigator.connection?.saveData)return;started=true;const s=document.createElement('script');s.type='module';s.defer=true;s.src=src;s.setAttribute('data-qwik-loader','lazy');document.head.appendChild(s);};const prime=()=>{load();cleanup();};const cleanup=()=>triggers.forEach((event)=>document.removeEventListener(event,prime,listenerOpts));const triggers=['pointerdown','keydown','touchstart','focusin'];const listenerOpts={once:true,passive:true};triggers.forEach((event)=>document.addEventListener(event,prime,listenerOpts));document.addEventListener('visibilitychange',()=>{if(document.visibilityState==='visible')prime();},{once:true});})();`}},p=r?Kt(t)?{...t,manifest:{...r,core:void 0,preloader:void 0,injections:[...r?.injections??[],c]}}:{...r,core:void 0,preloader:void 0,injections:[...r?.injections??[],c]}:t;return pi(z(Bl,null,3,"CC_0"),{...e,base:n,serverData:s,manifest:p,qwikLoader:"never",preloader:!1,containerTagName:"html",containerAttributes:l,stream:e.stream??{static:{buffer:0},inOrder:["<html"]}})}var{router:jl,notFound:Dl}=Si({render:Il,qwikCityPlan:Tl,manifest:Wt}),iu={router:jl,notFound:Dl};export{iu as default,Dl as notFound,jl as router};
