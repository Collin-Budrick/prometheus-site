@import "tailwindcss";

@layer base {
  :root {
    color-scheme: light;
    --ink: 15 23 42;
    --muted: 71 85 105;
    --surface: 255 255 255;
    --surface-warm: 248 242 231;
    --surface-cool: 234 242 241;
    --accent: 249 115 22;
    --accent-strong: 194 65 12;
    --signal: 20 184 166;
    --signal-strong: 13 148 136;
    --shadow: 0 30px 60px rgba(15, 23, 42, 0.14);
    --radius: 26px;
    --motion-distance: 12px;
    --view-transition-duration: 320ms;
    --view-transition-duration-long: 520ms;
    --view-transition-ease: cubic-bezier(0.22, 1, 0.36, 1);
    --skeleton-base: 226 232 240;
    --skeleton-highlight: 248 250 252;
    --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  }

  body {
    @apply min-h-screen antialiased;
    color: rgb(var(--ink));
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif;
    background-color: rgb(var(--surface-warm));
    background-image:
      radial-gradient(circle at 12% 8%, rgb(var(--accent) / 0.18), transparent 52%),
      radial-gradient(circle at 86% 12%, rgb(var(--signal) / 0.16), transparent 48%),
      linear-gradient(140deg, rgb(var(--surface-warm)), rgb(var(--surface-cool)));
    position: relative;
    isolation: isolate;
  }

  html {
    scroll-behavior: smooth;
  }

  html,
  body {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  html::-webkit-scrollbar,
  body::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
  }

  @supports (view-transition-name: root) {
    :root {
      view-transition-name: root;
    }

    ::view-transition-group(root) {
      animation-duration: var(--view-transition-duration-long);
      animation-timing-function: var(--view-transition-ease);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    :root {
      --view-transition-duration: 0ms;
      --view-transition-duration-long: 0ms;
    }
  }

  body::before {
    content: "";
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(90deg, rgba(15, 23, 42, 0.04) 1px, transparent 1px),
      linear-gradient(0deg, rgba(15, 23, 42, 0.04) 1px, transparent 1px);
    background-size: 120px 120px;
    opacity: 0.4;
    pointer-events: none;
    z-index: 0;
  }

  a {
    @apply text-inherit no-underline;
  }
}

@layer utilities {
  @keyframes header-in {
    0% {
      opacity: 0;
      transform: translateY(12px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes card-in {
    0% {
      opacity: 0;
      transform: translateY(16px) scale(0.98);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  @keyframes pulse-dot {
    0% {
      transform: scale(1);
      box-shadow: 0 0 0 rgba(249, 115, 22, 0.3);
    }
    100% {
      transform: scale(1.12);
      box-shadow: 0 0 16px rgba(249, 115, 22, 0.5);
    }
  }

  @keyframes skeleton-shimmer {
    from {
      transform: translateX(-120%);
    }
    to {
      transform: translateX(120%);
    }
  }
}

@layer components {
  .app-shell {
    @apply relative flex min-h-screen flex-col;
    z-index: 1;
  }

  html[data-motion-ready='true'] [data-motion] {
    opacity: 0;
    transform: translateY(var(--motion-distance));
    will-change: transform, opacity;
  }

  html[data-motion-ready='true'] [data-motion][data-motion-state='in'] {
    opacity: 1;
    transform: translateY(0);
    will-change: transform, opacity;
  }

  @media (prefers-reduced-motion: reduce) {
    html[data-motion-ready='true'] [data-motion],
    html[data-motion-ready='true'] [data-motion][data-motion-state='in'] {
      opacity: 1;
      transform: none;
      will-change: auto;
    }
  }

  @supports (view-transition-name: root) {
    [data-view-transition='shell-header'] {
      view-transition-name: shell-header;
    }

    [data-view-transition='shell-nav'] {
      view-transition-name: shell-nav;
    }

    [data-view-transition='shell-main'] {
      view-transition-name: shell-main;
    }

    ::view-transition-old(shell-header),
    ::view-transition-new(shell-header),
    ::view-transition-old(shell-nav),
    ::view-transition-new(shell-nav) {
      animation-duration: var(--view-transition-duration);
      animation-timing-function: var(--view-transition-ease);
    }

    ::view-transition-old(shell-main),
    ::view-transition-new(shell-main) {
      animation-duration: var(--view-transition-duration-long);
      animation-timing-function: var(--view-transition-ease);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    @supports (view-transition-name: root) {
      [data-view-transition] {
        view-transition-name: none !important;
      }

      ::view-transition-old(shell-header),
      ::view-transition-new(shell-header),
      ::view-transition-old(shell-nav),
      ::view-transition-new(shell-nav),
      ::view-transition-old(shell-main),
      ::view-transition-new(shell-main) {
        animation-duration: 0.001ms !important;
        animation-delay: 0s !important;
      }
    }
  }

  .layout-shell {
    @apply mx-auto w-full max-w-6xl px-6 py-10 sm:px-10;
  }

  .topbar {
    @apply flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between;
    animation: header-in 0.8s var(--view-transition-ease) both;
    will-change: transform, opacity;
  }

  .brand {
    @apply flex items-center gap-4;
  }

  .brand-mark {
    @apply relative h-12 w-12 rounded-[18px];
    background: conic-gradient(
      from 140deg,
      rgb(var(--accent) / 0.95),
      rgb(var(--signal) / 0.9),
      rgb(var(--accent) / 0.9)
    );
    box-shadow: 0 18px 40px rgba(249, 115, 22, 0.18);
  }

  .brand-mark::after {
    content: "";
    position: absolute;
    inset: 3px;
    border-radius: 14px;
    background: linear-gradient(160deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.6));
    box-shadow: inset 0 0 12px rgba(15, 23, 42, 0.1);
  }

  .brand-title {
    @apply flex flex-col leading-tight;
  }

  .brand-title strong {
    @apply text-lg font-semibold tracking-[0.4em] text-slate-900;
  }

  .brand-title span {
    @apply text-[11px] uppercase tracking-[0.4em] text-slate-500;
  }

  .nav-links {
    @apply flex flex-wrap gap-4;
    @apply font-mono text-[11px] uppercase tracking-[0.35em] text-slate-500;
  }

  .nav-links a {
    @apply border-b border-transparent pb-1 transition-all hover:border-amber-400 hover:text-slate-900;
  }

  .skeleton {
    @apply relative overflow-hidden;
    background-color: rgb(var(--skeleton-base) / 0.6);
    color: transparent;
    border-radius: 14px;
    isolation: isolate;
  }

  .skeleton::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent, rgb(var(--skeleton-highlight) / 0.95), transparent);
    transform: translateX(-120%);
    animation: skeleton-shimmer 1.4s var(--view-transition-ease) infinite;
    will-change: transform, opacity;
    opacity: 0.85;
  }

  .skeleton.inline {
    height: 0.9em;
    border-radius: 9999px;
  }

  .skeleton.block {
    min-height: 120px;
  }

  @media (prefers-reduced-motion: reduce) {
    .topbar {
      animation: none;
      will-change: auto;
    }

    .skeleton::after {
      animation-duration: 0.001ms;
      opacity: 0.6;
    }
  }

  .fragment-shell {
    @apply mt-6 space-y-5;
  }

  .fragment-status {
    @apply inline-flex items-center gap-2 rounded-full border border-amber-200/70 bg-white/70 px-4 py-2;
    @apply font-mono text-[11px] uppercase tracking-[0.35em] text-slate-600;
  }

  .fragment-status .dot {
    @apply h-2 w-2 rounded-full bg-amber-400;
    animation: pulse-dot 1.4s ease-in-out infinite alternate;
  }

  .fragment-grid {
    @apply flex flex-col gap-6;
  }

  .fragment-grid > .fragment-card {
    flex: 1 1 100%;
    min-width: 0;
  }

  @media (min-width: 640px) {
    .fragment-grid {
      flex-direction: row;
      flex-wrap: wrap;
    }

    .fragment-grid > .fragment-card {
      flex-basis: 240px;
    }
  }

  @media (min-width: 900px) {
    .fragment-grid {
      display: grid;
      grid-template-columns: repeat(12, minmax(0, 1fr));
    }
  }

  .fragment-card {
    @apply relative overflow-hidden rounded-[var(--radius)] border border-amber-100/80 bg-white/80 p-6;
    box-shadow: 0 18px 36px rgba(15, 23, 42, 0.12);
    background-color: rgb(var(--surface) / 0.9);
  }

  .fragment-card.is-expanded {
    position: fixed;
    inset: 0;
    width: 100vw;
    height: 100vh;
    z-index: 60;
    border-radius: 0;
    overflow: auto;
  }

  .fragment-card-close {
    position: fixed;
    top: 18px;
    right: 18px;
    z-index: 70;
    width: 38px;
    height: 38px;
    border-radius: 9999px;
    border: 1px solid rgba(148, 163, 184, 0.6);
    background: rgba(255, 255, 255, 0.88);
    color: rgb(var(--ink));
    display: grid;
    place-items: center;
    padding: 0;
    box-shadow: 0 12px 24px rgba(15, 23, 42, 0.16);
    transition: transform 160ms ease, box-shadow 160ms ease, background-color 160ms ease;
  }

  .fragment-card-close::before,
  .fragment-card-close::after {
    content: "";
    position: absolute;
    width: 16px;
    height: 2px;
    background: currentColor;
    border-radius: 9999px;
  }

  .fragment-card-close::before {
    transform: rotate(45deg);
  }

  .fragment-card-close::after {
    transform: rotate(-45deg);
  }

  .fragment-card-close:hover {
    background: rgb(var(--surface));
    box-shadow: 0 16px 28px rgba(15, 23, 42, 0.2);
    transform: translateY(-1px);
  }

  .fragment-card-close:focus-visible {
    outline: 2px solid rgb(var(--accent));
    outline-offset: 3px;
  }

  .fragment-card-placeholder {
    visibility: hidden;
    pointer-events: none;
  }

  body.card-expanded {
    overflow: hidden;
  }

  .skeleton-line {
    @apply block rounded-full bg-slate-200/70;
    height: 14px;
    animation: pulse 1.4s ease-in-out infinite;
  }

  .skeleton-line.is-short {
    width: 20%;
  }

  .skeleton-line.is-medium {
    width: 45%;
  }

  .skeleton-line.is-long {
    width: 80%;
  }

  .skeleton-line.is-button {
    width: 32%;
    height: 42px;
    border-radius: 9999px;
  }

  @keyframes pulse {
    0% {
      opacity: 0.65;
    }
    50% {
      opacity: 1;
    }
    100% {
      opacity: 0.65;
    }
  }

  @supports (backdrop-filter: blur(8px)) {
    .fragment-card {
      backdrop-filter: blur(8px);
      box-shadow: var(--shadow);
      background-color: rgb(var(--surface) / 0.82);
    }

    /* Add the .reduced-effects class on a parent or the card itself to disable blur for low-power scenarios. */
    .reduced-effects .fragment-card,
    .fragment-card.reduced-effects {
      backdrop-filter: none;
      box-shadow: 0 14px 28px rgba(15, 23, 42, 0.12);
      background-color: rgb(var(--surface) / 0.9);
    }
  }

  .fragment-card::after {
    content: "";
    position: absolute;
    inset: 0;
    background:
      radial-gradient(circle at top right, rgb(var(--accent) / 0.18), transparent 45%),
      radial-gradient(circle at bottom left, rgb(var(--signal) / 0.18), transparent 40%);
    opacity: 0;
    transition: opacity 200ms ease;
    pointer-events: none;
  }

  .fragment-card:hover::after {
    opacity: 1;
  }

  .fragment-card h1,
  .fragment-card h2,
  .fragment-card h3 {
    @apply mb-3 text-xl font-semibold text-slate-900;
  }

  .fragment-card p {
    @apply text-sm leading-6 text-slate-600;
  }

  .fragment-placeholder {
    @apply rounded-[20px] border border-dashed border-amber-200/70 bg-amber-50/40 p-5 text-sm text-slate-500;
  }

  .meta-line {
    @apply mb-3 flex flex-wrap gap-2 font-mono text-[11px] uppercase tracking-[0.35em] text-slate-500;
  }

  .badge {
    @apply inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1;
    @apply font-mono text-[10px] uppercase tracking-[0.35em] text-slate-600;
  }

  .badge.accent {
    @apply border-amber-200/80 bg-amber-50 text-amber-700;
  }

  .badge.signal {
    @apply border-teal-200/80 bg-teal-50 text-teal-700;
  }

  .inline-list {
    @apply mt-4 flex flex-col gap-3 p-0;
    @apply font-mono text-[11px] uppercase tracking-[0.35em] text-slate-500;
    list-style: none;
  }

  .inline-list li {
    @apply flex items-center gap-3;
  }

  .inline-list span {
    @apply h-2.5 w-2.5 rounded-full bg-amber-400;
    box-shadow: 0 0 12px rgba(249, 115, 22, 0.35);
  }

  .matrix {
    @apply mt-4 grid gap-3;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  }

  .matrix .cell {
    @apply rounded-2xl border border-slate-200/70 bg-white/70 p-4;
    @apply font-mono text-[11px] uppercase tracking-[0.35em] text-slate-500;
  }

  .matrix .cell strong {
    @apply mt-2 block text-base font-semibold text-slate-900;
  }

  .action-button {
    @apply inline-flex items-center gap-2 rounded-full bg-amber-400 px-5 py-3;
    @apply font-mono text-[11px] uppercase tracking-[0.35em] text-slate-900;
    box-shadow: 0 16px 30px rgba(249, 115, 22, 0.3);
    transition: transform 160ms ease, box-shadow 160ms ease;
  }

  .action-button:hover {
    transform: translateY(-1px);
    box-shadow: 0 22px 36px rgba(249, 115, 22, 0.35);
  }

  .preact-island {
    @apply mt-4 rounded-2xl border border-teal-200/80 bg-white/70 p-4;
  }

  .preact-island button {
    @apply mt-3 rounded-full border border-slate-200 bg-white px-4 py-2;
    @apply font-mono text-[11px] uppercase tracking-[0.35em] text-slate-600;
    transition: color 160ms ease, border-color 160ms ease, transform 160ms ease;
  }

  .preact-island button:hover {
    @apply border-teal-300 text-teal-700;
    transform: translateY(-1px);
  }
}
